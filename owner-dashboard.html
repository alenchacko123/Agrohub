<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AgroHub - Owner Dashboard</title>
    <meta name="description"
        content="Your AgroHub owner dashboard. Manage equipment listings, track rentals, and grow your business.">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">

    <style>
        :root {
            --primary-blue: #0077b6;
            --dark-blue: #023e8a;
            --light-blue: #caf0f8;
            --accent-gold: #ffd60a;
            --accent-orange: #fb8500;
            --owner-accent: #0096c7;
            --owner-light: #90e0ef;
            --text-dark: #1a1a2e;
            --text-gray: #4a5568;
            --text-light: #a0aec0;
            --white: #ffffff;
            --cream: #fdfbf7;
            --error: #ef4444;
            --success: #22c55e;
            --warning: #f59e0b;
            --info: #3b82f6;
            --sidebar-width: 280px;
            --font-serif: 'Playfair Display', serif;
            --font-sans: 'Inter', sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-sans);
            color: var(--text-dark);
            line-height: 1.6;
            background: linear-gradient(135deg, #caf0f8 0%, #ade8f4 50%, #90e0ef 100%);
            min-height: 100vh;
        }

        /* Dashboard Layout */
        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--dark-blue) 0%, var(--primary-blue) 100%);
            color: var(--white);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
            transition: transform 0.3s ease;
            box-shadow: 4px 0 25px rgba(2, 62, 138, 0.3);
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-family: var(--font-serif);
            font-size: 1.5rem;
            font-weight: 700;
            text-decoration: none;
            color: var(--white);
        }

        .sidebar-logo .material-icons-outlined {
            font-size: 2rem;
            background: linear-gradient(135deg, var(--accent-gold), var(--accent-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }
        }

        .sidebar-user {
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-gold), var(--accent-orange));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.25rem;
            color: var(--text-dark);
            box-shadow: 0 4px 15px rgba(255, 214, 10, 0.3);
        }

        .user-info h4 {
            font-size: 0.95rem;
            font-weight: 600;
        }

        .user-info span {
            font-size: 0.75rem;
            opacity: 0.8;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .user-info .status-dot {
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
            animation: blink 2s infinite;
        }

        .user-info .badge-verified {
            background: rgba(34, 197, 94, 0.2);
            color: #4ade80;
            padding: 0.1rem 0.5rem;
            border-radius: 50px;
            font-size: 0.65rem;
            font-weight: 600;
            margin-left: 0.25rem;
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-family: var(--font-serif);
            font-size: 1.5rem;
            font-weight: 700;
            text-decoration: none;
            color: var(--white);
        }

        .sidebar-logo .material-icons-outlined {
            font-size: 2rem;
            background: linear-gradient(135deg, var(--accent-gold), var(--accent-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }
        }

        .sidebar-user {
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-gold), var(--accent-orange));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.25rem;
            color: var(--text-dark);
            box-shadow: 0 4px 15px rgba(255, 214, 10, 0.3);
        }

        .user-info h4 {
            font-size: 0.95rem;
            font-weight: 600;
        }

        .user-info span {
            font-size: 0.75rem;
            opacity: 0.8;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .user-info .status-dot {
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
            animation: blink 2s infinite;
        }

        .user-info .badge-verified {
            background: rgba(34, 197, 94, 0.2);
            color: #4ade80;
            padding: 0.1rem 0.5rem;
            border-radius: 50px;
            font-size: 0.65rem;
            font-weight: 600;
            margin-left: 0.25rem;
        }

        @keyframes blink {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        /* Navigation */
        .sidebar-nav {
            padding: 1rem 0;
        }

        .nav-section {
            padding: 0.5rem 1.5rem;
            margin-top: 0.5rem;
        }

        .nav-section-title {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            opacity: 0.5;
            margin-bottom: 0.75rem;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.85rem 1.5rem;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
            margin: 0.25rem 0.75rem;
            border-radius: 12px;
        }

        .nav-item:hover,
        .nav-item.active {
            background: rgba(255, 255, 255, 0.1);
            color: var(--white);
        }

        .nav-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 60%;
            background: linear-gradient(180deg, var(--accent-gold), var(--accent-orange));
            border-radius: 0 4px 4px 0;
        }

        .nav-item .material-icons-outlined {
            font-size: 1.25rem;
        }

        .nav-item .badge {
            margin-left: auto;
            background: var(--accent-orange);
            color: var(--white);
            font-size: 0.7rem;
            padding: 0.15rem 0.5rem;
            border-radius: 50px;
            font-weight: 600;
        }

        .nav-item .badge.success {
            background: var(--success);
        }

        .nav-item .badge.warning {
            background: var(--warning);
        }

        .sidebar-footer {
            padding: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: auto;
        }

        .logout-btn {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            width: 100%;
            padding: 0.85rem 1rem;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #fca5a5;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .logout-btn:hover {
            background: rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.5);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 2rem;
        }

        /* Top Bar */
        .topbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            background: var(--white);
            padding: 1rem 1.5rem;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        }

        .topbar-left h1 {
            font-family: var(--font-serif);
            font-size: 1.75rem;
            color: var(--text-dark);
        }

        .topbar-left .breadcrumb {
            font-size: 0.85rem;
            color: var(--text-light);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.25rem;
        }

        .topbar-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .search-box {
            position: relative;
        }

        .search-box input {
            padding: 0.75rem 1rem 0.75rem 2.75rem;
            border: 2px solid #e5e7eb;
            border-radius: 50px;
            width: 280px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            background: #fafafa;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary-blue);
            background: var(--white);
            box-shadow: 0 0 0 4px rgba(0, 119, 182, 0.1);
        }

        .search-box .material-icons-outlined {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
        }

        .icon-btn {
            width: 45px;
            height: 45px;
            border-radius: 12px;
            border: 2px solid #e5e7eb;
            background: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .icon-btn:hover {
            border-color: var(--primary-blue);
            background: var(--light-blue);
        }

        .icon-btn .notification-dot {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 10px;
            height: 10px;
            background: var(--error);
            border-radius: 50%;
            border: 2px solid var(--white);
        }

        /* Quick Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--white);
            border-radius: 20px;
            padding: 1.5rem;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 119, 182, 0.15);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-blue), var(--accent-gold));
        }

        .stat-card.earnings::before {
            background: linear-gradient(90deg, #22c55e, #4ade80);
        }

        .stat-card.bookings::before {
            background: linear-gradient(90deg, #f59e0b, #fbbf24);
        }

        .stat-card.equipment::before {
            background: linear-gradient(90deg, #3b82f6, #60a5fa);
        }

        .stat-card.reviews::before {
            background: linear-gradient(90deg, #8b5cf6, #a78bfa);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .stat-card.earnings .stat-icon {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(74, 222, 128, 0.2));
            color: #22c55e;
        }

        .stat-card.bookings .stat-icon {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(251, 191, 36, 0.2));
            color: #f59e0b;
        }

        .stat-card.equipment .stat-icon {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(96, 165, 250, 0.2));
            color: #3b82f6;
        }

        .stat-card.reviews .stat-icon {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(167, 139, 250, 0.2));
            color: #8b5cf6;
        }

        .stat-trend {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 50px;
            font-weight: 600;
        }

        .stat-trend.up {
            background: rgba(34, 197, 94, 0.1);
            color: #22c55e;
        }

        .stat-trend.down {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-gray);
        }

        /* Quick Actions & Services */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 1.5rem;
        }

        .card {
            background: var(--white);
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .card-header h2 {
            font-family: var(--font-serif);
            font-size: 1.25rem;
            color: var(--text-dark);
        }

        .card-header .view-all {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.85rem;
            color: var(--primary-blue);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .card-header .view-all:hover {
            gap: 0.5rem;
        }

        /* Services Grid */
        .services-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }

        .service-card {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 16px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 2px solid transparent;
            text-decoration: none;
            color: var(--text-dark);
        }

        .service-card:hover {
            transform: translateY(-8px);
            border-color: var(--primary-blue);
            box-shadow: 0 15px 35px rgba(0, 119, 182, 0.15);
            background: var(--white);
        }

        .service-icon {
            width: 65px;
            height: 65px;
            margin: 0 auto 1rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .service-card:nth-child(1) .service-icon {
            background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue));
            color: var(--white);
        }

        .service-card:nth-child(2) .service-icon {
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: var(--white);
        }

        .service-card:nth-child(3) .service-icon {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: var(--white);
        }

        .service-card:nth-child(4) .service-icon {
            background: linear-gradient(135deg, #8b5cf6, #6d28d9);
            color: var(--white);
        }

        .service-card:nth-child(5) .service-icon {
            background: linear-gradient(135deg, #ec4899, #be185d);
            color: var(--white);
        }

        .service-card:nth-child(6) .service-icon {
            background: linear-gradient(135deg, #14b8a6, #0d9488);
            color: var(--white);
        }

        .service-card:hover .service-icon {
            transform: scale(1.1) rotate(5deg);
        }

        .service-icon .material-icons-outlined {
            font-size: 28px;
        }

        .service-card h3 {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .service-card p {
            font-size: 0.8rem;
            color: var(--text-gray);
        }

        /* Recent Bookings */
        .booking-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .booking-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .booking-item:hover {
            background: var(--light-blue);
        }

        .booking-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-blue), var(--owner-accent));
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-weight: 600;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .booking-content {
            flex: 1;
        }

        .booking-content h4 {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .booking-content p {
            font-size: 0.8rem;
            color: var(--text-gray);
        }

        .booking-meta {
            text-align: right;
        }

        .booking-price {
            font-size: 0.95rem;
            font-weight: 700;
            color: var(--success);
            margin-bottom: 0.25rem;
        }

        .booking-status {
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            border-radius: 50px;
            font-weight: 600;
        }

        .booking-status.pending {
            background: rgba(245, 158, 11, 0.1);
            color: #f59e0b;
        }

        .booking-status.confirmed {
            background: rgba(34, 197, 94, 0.1);
            color: #22c55e;
        }

        .booking-status.active {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }

        /* Quick Actions Panel */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .quick-action-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue));
            color: var(--white);
            border: none;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quick-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 119, 182, 0.3);
        }

        .quick-action-btn.secondary {
            background: var(--white);
            color: var(--primary-blue);
            border: 2px solid var(--primary-blue);
        }

        .quick-action-btn.secondary:hover {
            background: var(--light-blue);
        }

        /* Equipment Listing Section */
        .equipment-section {
            margin-top: 1.5rem;
        }

        .equipment-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
        }

        .equipment-card {
            background: var(--white);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            position: relative;
        }

        .equipment-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 119, 182, 0.15);
        }

        .equipment-image {
            height: 140px;
            background: linear-gradient(135deg, #e2e8f0, #f1f5f9);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .equipment-image .material-icons-outlined {
            font-size: 48px;
            color: var(--text-light);
        }

        .equipment-badge {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: var(--success);
            color: var(--white);
            font-size: 0.7rem;
            padding: 0.25rem 0.5rem;
            border-radius: 50px;
            font-weight: 600;
        }

        .equipment-badge.rented {
            background: var(--info);
        }

        .equipment-badge.maintenance {
            background: var(--warning);
        }

        .equipment-actions {
            position: absolute;
            top: 0.5rem;
            left: 0.5rem;
            display: flex;
            gap: 0.25rem;
        }

        .equipment-action-btn {
            width: 30px;
            height: 30px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .equipment-action-btn:hover {
            background: var(--white);
            transform: scale(1.1);
        }

        .equipment-action-btn .material-icons-outlined {
            font-size: 16px;
            color: var(--text-gray);
        }

        .equipment-info {
            padding: 1rem;
        }

        .equipment-info h4 {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .equipment-info p {
            font-size: 0.8rem;
            color: var(--text-gray);
            margin-bottom: 0.5rem;
        }

        .equipment-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .equipment-price {
            font-size: 1rem;
            font-weight: 700;
            color: var(--primary-blue);
        }

        .equipment-price span {
            font-size: 0.75rem;
            font-weight: 400;
            color: var(--text-light);
        }

        .equipment-rentals {
            font-size: 0.75rem;
            color: var(--text-gray);
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        /* Earnings Chart Widget */
        .earnings-widget {
            background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue));
            border-radius: 16px;
            padding: 1.5rem;
            color: var(--white);
            margin-bottom: 1rem;
        }

        .earnings-widget h4 {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
        }

        .earnings-main {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .earnings-amount {
            font-size: 2rem;
            font-weight: 700;
        }

        .earnings-growth {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            background: rgba(255, 255, 255, 0.2);
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.85rem;
        }

        .earnings-chart {
            margin-top: 1rem;
            display: flex;
            align-items: flex-end;
            gap: 0.5rem;
            height: 60px;
        }

        .chart-bar {
            flex: 1;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px 4px 0 0;
            transition: all 0.3s ease;
        }

        .chart-bar:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        /* Mobile Sidebar Toggle */
        .mobile-toggle {
            display: none;
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue));
            border-radius: 50%;
            border: none;
            color: var(--white);
            cursor: pointer;
            z-index: 150;
            box-shadow: 0 8px 25px rgba(0, 119, 182, 0.4);
            transition: all 0.3s ease;
        }

        .mobile-toggle:hover {
            transform: scale(1.1);
        }

        /* Responsive Design */
        @media (max-width: 1280px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .services-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .equipment-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .mobile-toggle {
                display: flex;
                align-items: center;
                justify-content: center;
            }
        }

        @media (max-width: 768px) {
            .topbar {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }

            .topbar-right {
                width: 100%;
            }

            .search-box input {
                width: 100%;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .services-grid {
                grid-template-columns: 1fr;
            }

            .equipment-grid {
                grid-template-columns: 1fr;
            }

            .quick-actions {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .stat-card,
        .service-card,
        .card {
            animation: fadeIn 0.5s ease-out forwards;
        }

        .stat-card:nth-child(1) {
            animation-delay: 0.1s;
        }

        .stat-card:nth-child(2) {
            animation-delay: 0.2s;
        }

        .stat-card:nth-child(3) {
            animation-delay: 0.3s;
        }

        .stat-card:nth-child(4) {
            animation-delay: 0.4s;
        }

        /* Floating Elements */
        .floating-elements {
            position: fixed;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .floating-icon {
            position: absolute;
            font-size: 2rem;
            opacity: 0.08;
            animation: floatIcon 15s ease-in-out infinite;
            color: var(--primary-blue);
        }

        .floating-icon:nth-child(1) {
            left: 35%;
            top: 20%;
            animation-delay: 0s;
        }

        .floating-icon:nth-child(2) {
            left: 65%;
            top: 40%;
            animation-delay: 3s;
        }

        .floating-icon:nth-child(3) {
            left: 45%;
            top: 70%;
            animation-delay: 6s;
        }

        @keyframes floatIcon {

            0%,
            100% {
                transform: translateY(0) rotate(0deg);
                opacity: 0.08;
            }

            50% {
                transform: translateY(-20px) rotate(15deg);
                opacity: 0.15;
            }
        }

        /* Tooltip */
        .tooltip {
            position: relative;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 120%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--text-dark);
            color: var(--white);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .tooltip:hover::after {
            opacity: 1;
            visibility: visible;
        }

        .rating-stars {
            display: flex;
            gap: 0.1rem;
            color: #fbbf24;
        }

        .rating-stars .material-icons-outlined {
            font-size: 1rem;
        }

        /* Notification Badge */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--error);
            color: var(--white);
            border-radius: 50%;
            min-width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 700;
            animation: pulse-badge 2s infinite;
        }

        @keyframes pulse-badge {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }
        }

        /* Notifications Panel */
        #notificationsPanel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: var(--white);
            box-shadow: -5px 0 25px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            transition: right 0.3s ease;
            overflow-y: auto;
        }

        #notificationsPanel.active {
            right: 0;
        }

        .notification-header {
            padding: 1.5rem;
            background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue));
            color: var(--white);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .notification-header h3 {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .close-panel {
            background: none;
            border: none;
            color: var(--white);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: background 0.3s;
        }

        .close-panel:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .notification-list {
            padding: 1rem;
        }

        .notification-item {
            background: var(--white);
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            transition: all 0.3s;
        }

        .notification-item:hover {
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .notification-item.pending {
            border-left: 4px solid var(--warning);
        }

        .notification-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }

        .notification-details {
            font-size: 0.85rem;
            color: var(--text-gray);
            margin-bottom: 0.75rem;
        }

        .notification-details div {
            margin-bottom: 0.25rem;
        }

        .notification-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .btn-accept {
            flex: 1;
            padding: 0.6rem;
            background: linear-gradient(135deg, var(--success), #16a34a);
            color: var(--white);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-accept:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
        }

        .btn-decline {
            flex: 1;
            padding: 0.6rem;
            background: linear-gradient(135deg, var(--error), #dc2626);
            color: var(--white);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-decline:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }

        .empty-notifications {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--text-light);
        }

        .empty-notifications .material-icons-outlined {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .notification-time {
            font-size: 0.75rem;
            color: var(--text-light);
            margin-top: 0.5rem;
        }
    </style>
</head>

<body>
    <!-- Floating Background Elements -->
    <div class="floating-elements">
        <span class="floating-icon material-icons-outlined">agriculture</span>
        <span class="floating-icon material-icons-outlined">inventory_2</span>
        <span class="floating-icon material-icons-outlined">storefront</span>
    </div>

    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="landingpage.html" class="sidebar-logo">
                    <span class="material-icons-outlined">spa</span>
                    AgroHub
                </a>
            </div>

            <div class="sidebar-user">
                <div class="user-avatar" id="user-avatar">U</div>
                <div class="user-info">
                    <h4 id="user-name">User <span class="badge-verified">âœ“ Verified</span></h4>
                    <span><span class="status-dot"></span> Equipment Owner</span>
                </div>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <span class="nav-section-title">Main Menu</span>
                </div>
                <a href="#" class="nav-item active">
                    <span class="material-icons-outlined">dashboard</span>
                    Dashboard
                </a>
                <a href="#" class="nav-item">
                    <span class="material-icons-outlined">inventory_2</span>
                    My Equipment
                    <span class="badge" id="equipmentCountBadge">0</span>
                </a>
                <a href="#" class="nav-item">
                    <span class="material-icons-outlined">add_circle</span>
                    Add New Listing
                </a>

                <div class="nav-section">
                    <span class="nav-section-title">Rentals</span>
                </div>
                <a href="#" class="nav-item">
                    <span class="material-icons-outlined">event_note</span>
                    Booking Requests
                    <span class="badge warning" id="bookingRequestsBadge">0</span>
                </a>
                <a href="#" class="nav-item">
                    <span class="material-icons-outlined">check_circle</span>
                    Active Rentals
                    <span class="badge success" id="activeRentalsBadge">0</span>
                </a>
                <a href="#" class="nav-item">
                    <span class="material-icons-outlined">history</span>
                    Rental History
                </a>

                <div class="nav-section">
                    <span class="nav-section-title">Business</span>
                </div>
                <a href="#" class="nav-item">
                    <span class="material-icons-outlined">account_balance_wallet</span>
                    Earnings
                </a>
                <a href="#" class="nav-item">
                    <span class="material-icons-outlined">analytics</span>
                    Analytics
                </a>
                <a href="#" class="nav-item">
                    <span class="material-icons-outlined">description</span>
                    Agreements
                    <span class="badge" id="agreementsBadge" style="display: none;">0</span>
                </a>

                <div class="nav-section">
                    <span class="nav-section-title">Account</span>
                </div>
                <a href="#" class="nav-item">
                    <span class="material-icons-outlined">star</span>
                    Reviews & Ratings
                </a>
                <a href="#" class="nav-item">
                    <span class="material-icons-outlined">person</span>
                    My Profile
                </a>
                <a href="#" class="nav-item">
                    <span class="material-icons-outlined">settings</span>
                    Settings
                </a>
            </nav>

            <div class="sidebar-footer">
                <button class="logout-btn" onclick="logout()">
                    <span class="material-icons-outlined">logout</span>
                    Sign Out
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Bar -->
            <div class="topbar">
                <div class="topbar-left">
                    <h1 id="welcome-message">Welcome back! ðŸ‘‹</h1>
                    <div class="breadcrumb">
                        <span class="material-icons-outlined" style="font-size: 1rem;">home</span>
                        Owner Dashboard / Overview
                    </div>
                </div>
                <div class="topbar-right">
                    <div class="search-box">
                        <span class="material-icons-outlined">search</span>
                        <input type="text" placeholder="Search equipment, bookings...">
                    </div>
                    <button id="notificationsBtn" class="icon-btn tooltip" data-tooltip="Notifications"
                        onclick="toggleNotificationsPanel()">
                        <span class="material-icons-outlined">notifications</span>
                        <span class="notification-badge" id="notificationCount" style="display: none;">0</span>
                    </button>
                    <button class="icon-btn tooltip" data-tooltip="Messages">
                        <span class="material-icons-outlined">chat</span>
                    </button>
                </div>
            </div>

            <!-- Stats Overview -->
            <div class="stats-grid">
                <div class="stat-card earnings">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <span class="material-icons-outlined">account_balance_wallet</span>
                        </div>
                        <span class="stat-trend neutral">
                            0%
                        </span>
                    </div>
                    <div class="stat-value" id="totalEarnings">â‚¹0</div>
                    <div class="stat-label">Total Earnings</div>
                </div>

                <div class="stat-card bookings">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <span class="material-icons-outlined">event_available</span>
                        </div>
                        <span class="stat-trend neutral">
                            0%
                        </span>
                    </div>
                    <div class="stat-value" id="totalBookings">0</div>
                    <div class="stat-label">Total Bookings</div>
                </div>

                <div class="stat-card equipment">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <span class="material-icons-outlined">agriculture</span>
                        </div>
                        <span class="stat-trend neutral">0%</span>
                    </div>
                    <div class="stat-value" id="activeListings">0</div>
                    <div class="stat-label">Active Listings</div>
                </div>

                <div class="stat-card reviews">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <span class="material-icons-outlined">star</span>
                        </div>
                        <span class="stat-trend neutral">
                            0%
                        </span>
                    </div>
                    <div class="stat-value" id="avgRating">0.0</div>
                    <div class="stat-label">Average Rating</div>
                </div>
            </div>

            <!-- Dashboard Content -->
            <div class="dashboard-grid" style="grid-template-columns: 1fr;">
                <!-- Recent Bookings and Availability -->
                <div class="dashboard-row"
                    style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 2rem;margin-bottom: 2rem;">
                    <!-- Recent Bookings -->
                    <div class="card"
                        style="background: var(--white); padding: 2rem; border-radius: 24px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); border: 1px solid rgba(0,119,182, 0.1);">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <div>
                                <h2
                                    style="font-family:var(--font-serif); font-size: 1.5rem; color: var(--text-dark); margin-bottom: 0.25rem;">
                                    ðŸ“‹ Recent Bookings</h2>
                                <p style="font-size: 0.85rem; color: var(--text-gray);">Latest rental requests from
                                    farmers</p>
                            </div>
                            <a href="#" class="view-all" onclick="showAllBookings(); return false;"
                                style="display: inline-flex; align-items: center; gap: 0.5rem; text-decoration: none; color: var(--primary-blue); font-size: 0.9rem; font-weight: 600; padding: 0.5rem 1rem; border-radius: 8px; background: rgba(0,119,182,0.1); transition: all 0.3s;">
                                View All
                                <span class="material-icons-outlined" style="font-size: 1.2rem;">arrow_forward</span>
                            </a>
                        </div>
                        <div class="bookings-list" id="recentBookingsList"
                            style="display: flex; flex-direction: column; gap: 1rem;">
                            <!-- Loading state -->
                            <div style="padding: 3rem; text-align: center; color: var(--text-light);">
                                <span class="material-icons-outlined"
                                    style="font-size: 3rem; animation: spin 1s linear infinite; color: var(--primary-blue);">sync</span>
                                <p style="margin-top: 1rem; font-weight: 500;">Loading recent bookings...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Equipment Availability -->
                    <div class="card"
                        style="background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%); padding: 2rem; border-radius: 24px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); border: 1px solid rgba(0,119,182, 0.1);">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                            <div>
                                <h2
                                    style="font-family: var(--font-serif); font-size: 1.5rem; color: var(--text-dark); margin-bottom: 0.25rem;">
                                    ðŸ“Š Equipment Availability</h2>
                                <p style="font-size: 0.85rem; color: var(--text-gray);">Real-time status overview</p>
                            </div>
                            <span class="material-icons-outlined"
                                style="color: var(--primary-blue); font-size: 2rem;">inventory_2</span>
                        </div>
                        <div style="margin-top: 1.5rem;">
                            <!-- Rented Status -->
                            <div style="margin-bottom: 1.5rem;">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                    <div style="display: flex; align-items: center; gap: 0.75rem;">
                                        <div
                                            style="width: 12px; height: 12px; border-radius: 50%; background: var(--accent-orange);">
                                        </div>
                                        <span
                                            style="font-size: 0.95rem; font-weight: 500; color: var(--text-dark);">Currently
                                            Rented</span>
                                    </div>
                                    <span
                                        style="font-weight: 700; font-size: 1.1rem; color: var(--accent-orange);">15%</span>
                                </div>
                                <div
                                    style="height: 10px; background: rgba(251, 146, 60, 0.1); border-radius: 8px; overflow: hidden; box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);">
                                    <div
                                        style="width: 15%; height: 100%; background: linear-gradient(90deg, var(--accent-orange), #fbbf24); border-radius: 8px; transition: width 0.5s ease;">
                                    </div>
                                </div>
                            </div>

                            <!-- Available Status -->
                            <div style="margin-bottom: 1.5rem;">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                    <div style="display: flex; align-items: center; gap: 0.75rem;">
                                        <div
                                            style="width: 12px; height: 12px; border-radius: 50%; background: var(--success);">
                                        </div>
                                        <span
                                            style="font-size: 0.95rem; font-weight: 500; color: var(--text-dark);">Available</span>
                                    </div>
                                    <span style="font-weight: 700; font-size: 1.1rem; color: var(--success);">75%</span>
                                </div>
                                <div
                                    style="height: 10px; background: rgba(34, 197, 94, 0.1); border-radius: 8px; overflow: hidden; box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);">
                                    <div
                                        style="width: 75%; height: 100%; background: linear-gradient(90deg, var(--success), #4ade80); border-radius: 8px; transition: width 0.5s ease;">
                                    </div>
                                </div>
                            </div>

                            <!-- Maintenance Status -->
                            <div>
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                    <div style="display: flex; align-items: center; gap: 0.75rem;">
                                        <div
                                            style="width: 12px; height: 12px; border-radius: 50%; background: var(--error);">
                                        </div>
                                        <span
                                            style="font-size: 0.95rem; font-weight: 500; color: var(--text-dark);">Maintenance</span>
                                    </div>
                                    <span style="font-weight: 700; font-size: 1.1rem; color: var(--error);">10%</span>
                                </div>
                                <div
                                    style="height: 10px; background: rgba(239, 68, 68, 0.1); border-radius: 8px; overflow: hidden; box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);">
                                    <div
                                        style="width: 10%; height: 100%; background: linear-gradient(90deg, var(--error), #f87171); border-radius: 8px; transition: width 0.5s ease;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- My Equipment View (Hidden by default) -->
            <div id="myEquipmentView" style="display: none;">
                <div class="section-header"
                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; background: white; padding: 2rem; border-radius: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.05);">
                    <div>
                        <h2
                            style="font-family: var(--font-serif); font-size: 2rem; color: var(--text-dark); margin-bottom: 0.5rem;">
                            ðŸšœ My Equipment Listings</h2>
                        <p style="font-size: 0.95rem; color: var(--text-gray);">Manage your agricultural equipment
                            inventory</p>
                    </div>
                    <button onclick="openModal('addEquipmentModal')"
                        style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.85rem 1.5rem; background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue)); color: white; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 15px rgba(0,119,182,0.3);">
                        <span class="material-icons-outlined">add_circle</span>
                        Add New Equipment
                    </button>
                </div>

                <div class="equipment-grid" id="ownerEquipmentGrid"
                    style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 2rem;">
                    <!-- Equipment will be loaded dynamically -->
                    <div
                        style="grid-column: 1/-1; text-align: center; padding: 4rem; background: white; border-radius: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.05);">
                        <span class="material-icons-outlined"
                            style="font-size: 4rem; animation: spin 1s linear infinite; color: var(--primary-blue);">sync</span>
                        <p style="margin-top: 1rem; font-weight: 500; font-size: 1.1rem; color: var(--text-gray);">
                            Loading your equipment...</p>
                    </div>
                </div>
            </div>
    </div>

    <!-- All Bookings View (Hidden by default) -->
    <div id="allBookingsView" style="display: none;">
        <div class="section-header"
            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; background: white; padding: 2rem; border-radius: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.05);">
            <div>
                <h2
                    style="font-family: var(--font-serif); font-size: 2rem; color: var(--text-dark); margin-bottom: 0.5rem;">
                    ðŸ“‹ All Booking Requests</h2>
                <p style="font-size: 0.95rem; color: var(--text-gray);">Manage rental requests from farmers</p>
            </div>
            <div style="display: flex; gap: 1rem;">
                <select id="bookingStatusFilter" onchange="filterBookings(this.value)"
                    style="padding: 0.75rem 1rem; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 0.9rem; cursor: pointer;">
                    <option value="all">All Status</option>
                    <option value="pending">Pending</option>
                    <option value="approved">Approved</option>
                    <option value="rejected">Rejected</option>
                </select>
            </div>
        </div>

        <div id="allBookingsGrid" style="display: grid; gap: 1.5rem;">
            <!-- Bookings will be loaded dynamically -->
            <div
                style="text-align: center; padding: 4rem; background: white; border-radius: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.05);">
                <span class="material-icons-outlined"
                    style="font-size: 4rem; animation: spin 1s linear infinite; color: var(--primary-blue);">sync</span>
                <p style="margin-top: 1rem; font-weight: 500; font-size: 1.1rem; color: var(--text-gray);">Loading all
                    bookings...</p>
            </div>
        </div>
    </div>
    </main>
    </div>

    <!-- Add Equipment Modal -->
    <div class="modal" id="addEquipmentModal">
        <div class="modal-content" style="max-width: 800px;">
            <button class="close-modal" onclick="closeModal('addEquipmentModal')">
                <span class="material-icons-outlined">close</span>
            </button>
            <div class="modal-header">
                <h2 class="modal-title">ðŸ“¦ List New Equipment</h2>
                <p class="modal-subtitle">Fill in the details to attract potential renters/buyers</p>
            </div>
            <div class="modal-body">
                <form id="addEquipmentForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Equipment Name *</label>
                            <input type="text" id="equipment_name" name="equipment_name"
                                placeholder="e.g. John Deere 5050D" required>
                        </div>
                        <div class="form-group">
                            <label>Category *</label>
                            <select id="category" name="category" required>
                                <option value="">Select Category</option>
                                <option value="tractor">Tractor</option>
                                <option value="harvester">Harvester</option>
                                <option value="tiller">Tiller/Cultivator</option>
                                <option value="seeder">Seeder/Planter</option>
                                <option value="rotavator">Rotavator</option>
                                <option value="plough">Plough</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Price per Day (â‚¹) *</label>
                            <input type="number" id="price_per_day" name="price_per_day" placeholder="Enter amount"
                                required min="0" step="1">
                        </div>
                        <div class="form-group">
                            <label>Condition *</label>
                            <select id="condition" name="condition" required>
                                <option value="new">Brand New</option>
                                <option value="excellent">Excellent</option>
                                <option value="good">Good</option>
                                <option value="fair">Fair</option>
                            </select>
                        </div>
                    </div>

                    <!-- Specifications Section -->
                    <div style="margin-bottom: 0.5rem; margin-top: 1rem;">
                        <h4 style="font-size: 0.9rem; color: var(--text-gray); text-transform: uppercase;">Technical
                            Specifications</h4>
                        <hr
                            style="border: none; border-top: 1px solid #e2e8f0; margin-top: 0.5rem; margin-bottom: 1rem;">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Model / Variant</label>
                            <input type="text" id="model" name="model" placeholder="e.g. 5050D PowerPro">
                        </div>
                        <div class="form-group">
                            <label>Year of Manufacture</label>
                            <input type="number" id="year" name="year" placeholder="e.g. 2023" min="1990" max="2030">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Fuel Type</label>
                            <select id="fuel" name="fuel">
                                <option value="">Select Fuel Type</option>
                                <option value="Diesel">Diesel</option>
                                <option value="Petrol">Petrol</option>
                                <option value="Electric">Electric</option>
                                <option value="Hybrid">Hybrid</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Capacity / Power</label>
                            <input type="text" id="capacity" name="capacity" placeholder="e.g. 50 HP or 5 Tons">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Availability Status</label>
                        <select id="availability" name="availability">
                            <option value="available">Available Now</option>
                            <option value="booked">Already Booked</option>
                            <option value="maintenance">Under Maintenance</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Location *</label>
                        <input type="text" id="location" name="location" placeholder="e.g. Bangalore, Karnataka"
                            required>
                    </div>
                    <div class="form-group">
                        <label>Machine Images</label>
                        <div class="image-upload-box"
                            style="border: 2px dashed #cbd5e1; padding: 2rem; text-align: center; border-radius: 12px; cursor: pointer; position: relative;"
                            onclick="document.getElementById('fileInput').click()">
                            <div id="image-preview-container" style="display: none; margin-bottom: 1rem;">
                                <img id="image-preview" src="" alt="Preview"
                                    style="max-width: 100%; max-height: 200px; border-radius: 8px; object-fit: cover;">
                                <button type="button" onclick="removeImage(event)"
                                    style="position: absolute; top: 1rem; right: 1rem; background: rgba(239, 68, 68, 0.9); color: white; border: none; width: 30px; height: 30px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                                    <span class="material-icons-outlined" style="font-size: 18px;">close</span>
                                </button>
                            </div>
                            <div id="upload-placeholder">
                                <span class="material-icons-outlined"
                                    style="font-size: 3rem; color: var(--text-light);">add_a_photo</span>
                                <p style="color: var(--text-gray); margin-top: 0.5rem;">Click or drag images here</p>
                            </div>
                            <input type="file" id="fileInput" name="equipment_image" style="display: none;"
                                accept="image/*" onchange="previewEquipmentImage(this)">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Description & Features *</label>
                        <textarea id="description" name="description" rows="4"
                            placeholder="Mention specifications (HP, Year, Fuel type, etc.)" required></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary"
                    onclick="closeModal('addEquipmentModal')">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="submitNewListing()">Publish Listing</button>
            </div>
        </div>
    </div>

    <!-- Bookings Modal -->
    <div class="modal" id="bookingsModal">
        <div class="modal-content" style="max-width: 900px;">
            <button class="close-modal" onclick="closeModal('bookingsModal')">
                <span class="material-icons-outlined">close</span>
            </button>
            <div class="modal-header">
                <h2 class="modal-title">ðŸ“… Manage Bookings</h2>
                <p class="modal-subtitle">Review and manage your incoming rental requests</p>
            </div>
            <div class="modal-body">
                <div class="booking-table-container">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="text-align: left; border-bottom: 2px solid #f1f5f9;">
                                <th style="padding: 1rem;">Farmer</th>
                                <th style="padding: 1rem;">Equipment</th>
                                <th style="padding: 1rem;">Duration</th>
                                <th style="padding: 1rem;">Amount</th>
                                <th style="padding: 1rem;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="bookingsTableBody">
                            <tr>
                                <td colspan="5" style="padding: 3rem; text-align: center;">
                                    <span class="material-icons-outlined"
                                        style="font-size: 3rem; animation: spin 1s linear infinite; color: var(--text-light);">sync</span>
                                    <p style="margin-top: 1rem; color: var(--text-gray);">Loading booking requests...
                                    </p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Active Rentals Modal -->
    <div class="modal" id="activeRentalsModal">
        <div class="modal-content" style="max-width: 900px;">
            <button class="close-modal" onclick="closeModal('activeRentalsModal')">
                <span class="material-icons-outlined">close</span>
            </button>
            <div class="modal-header">
                <h2 class="modal-title">âœ… Active Rentals</h2>
                <p class="modal-subtitle">Currently rented out equipment and their status</p>
            </div>
            <div class="modal-body">
                <div class="booking-table-container">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="text-align: left; border-bottom: 2px solid #f1f5f9;">
                                <th style="padding: 1rem;">Machine</th>
                                <th style="padding: 1rem;">Farmer</th>
                                <th style="padding: 1rem;">Return Date</th>
                                <th style="padding: 1rem;">Condition</th>
                                <th style="padding: 1rem;">Action</th>
                            </tr>
                        </thead>
                        <tbody id="activeRentalsTableBody">
                            <tr>
                                <td colspan="5" style="padding: 3rem; text-align: center;">
                                    <span class="material-icons-outlined"
                                        style="font-size: 3rem; animation: spin 1s linear infinite; color: var(--text-light);">sync</span>
                                    <p style="margin-top: 1rem; color: var(--text-gray);">Loading active rentals...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Rental History Modal -->
    <div class="modal" id="rentalHistoryModal">
        <div class="modal-content" style="max-width: 900px;">
            <button class="close-modal" onclick="closeModal('rentalHistoryModal')">
                <span class="material-icons-outlined">close</span>
            </button>
            <div class="modal-header">
                <h2 class="modal-title">â³ Rental History</h2>
                <p class="modal-subtitle">Review your past successful rentals and earnings</p>
            </div>
            <div class="modal-body">
                <div class="booking-table-container">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="text-align: left; border-bottom: 2px solid #f1f5f9;">
                                <th style="padding: 1rem;">Equipment</th>
                                <th style="padding: 1rem;">Farmer</th>
                                <th style="padding: 1rem;">Date</th>
                                <th style="padding: 1rem;">Status</th>
                                <th style="padding: 1rem;">Earnings</th>
                            </tr>
                        </thead>
                        <tbody id="rentalHistoryTableBody">
                            <tr>
                                <td colspan="5" style="padding: 3rem; text-align: center;">
                                    <span class="material-icons-outlined"
                                        style="font-size: 3rem; animation: spin 1s linear infinite; color: var(--text-light);">sync</span>
                                    <p style="margin-top: 1rem; color: var(--text-gray);">Loading rental history...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Earnings Modal -->
    <div class="modal" id="earningsModal">
        <div class="modal-content" style="max-width: 800px;">
            <button class="close-modal" onclick="closeModal('earningsModal')">
                <span class="material-icons-outlined">close</span>
            </button>
            <div class="modal-header">
                <h2 class="modal-title">ðŸ’° Financial Overview</h2>
                <p class="modal-subtitle">Detailed breakdown of your machine rental income</p>
            </div>
            <div class="modal-body">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 2rem;">
                    <div
                        style="background: #f8fafc; padding: 1.5rem; border-radius: 16px; border-left: 4px solid var(--success);">
                        <div style="color: var(--text-gray); font-size: 0.9rem;">Wallet Balance</div>
                        <div style="font-size: 2rem; font-weight: 700; color: var(--text-dark);">â‚¹0</div>
                    </div>
                    <div
                        style="background: #f8fafc; padding: 1.5rem; border-radius: 16px; border-left: 4px solid var(--primary-blue);">
                        <div style="color: var(--text-gray); font-size: 0.9rem;">Pending Payouts</div>
                        <div style="font-size: 2rem; font-weight: 700; color: var(--text-dark);">â‚¹0</div>
                    </div>
                </div>
                <button class="btn btn-primary" style="width: 100%;"
                    onclick="alert('Withdrawal request sent!')">Withdraw to Bank</button>
            </div>
        </div>
    </div>

    <!-- Analytics Modal -->
    <div class="modal" id="analyticsModal">
        <div class="modal-content" style="max-width: 800px;">
            <button class="close-modal" onclick="closeModal('analyticsModal')">
                <span class="material-icons-outlined">close</span>
            </button>
            <div class="modal-header">
                <h2 class="modal-title">ðŸ“Š Business Analytics</h2>
                <p class="modal-subtitle">Track your machine usage and popularity trends</p>
            </div>
            <div class="modal-body">
                <div
                    style="background: #f1f5f9; padding: 2rem; border-radius: 16px; text-align: center; margin-bottom: 1.5rem;">
                    <span class="material-icons-outlined"
                        style="font-size: 4rem; color: var(--primary-blue);">insights</span>
                    <h3 style="margin-top: 1rem;">Profile Visibility +15%</h3>
                    <p style="color: var(--text-gray);">Your equipment was viewed 245 times this week.</p>
                </div>
                <div style="display: flex; gap: 1rem; justify-content: space-around;">
                    <div style="text-align: center;">
                        <div style="font-weight: 700; font-size: 1.5rem;">85%</div>
                        <div style="font-size: 0.8rem; color: var(--text-gray);">Utilization</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-weight: 700; font-size: 1.5rem;">4.8</div>
                        <div style="font-size: 0.8rem; color: var(--text-gray);">Avg Rating</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Reviews Modal -->
    <div class="modal" id="reviewsModal">
        <div class="modal-content" style="max-width: 700px;">
            <button class="close-modal" onclick="closeModal('reviewsModal')">
                <span class="material-icons-outlined">close</span>
            </button>
            <div class="modal-header">
                <h2 class="modal-title">â­ Reviews & Ratings</h2>
                <p class="modal-subtitle">Feedback from farmers who used your machines</p>
            </div>
            <div class="modal-body">
                <div style="display: flex; flex-direction: column; gap: 1rem;">
                    <div style="padding: 1rem; border: 1px solid #f1f5f9; border-radius: 12px; background: #fff;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span style="font-weight: 600;">Amit Patel</span>
                            <span style="color: #fbbf24;">â˜…â˜…â˜…â˜…â˜…</span>
                        </div>
                        <p style="font-size: 0.9rem; color: var(--text-gray);">"The tractor was in excellent condition.
                            Suresh was very helpful with the guidelines."</p>
                    </div>
                    <div style="padding: 1rem; border: 1px solid #f1f5f9; border-radius: 12px; background: #fff;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span style="font-weight: 600;">Vikram Singh</span>
                            <span style="color: #fbbf24;">â˜…â˜…â˜…â˜…â˜†</span>
                        </div>
                        <p style="font-size: 0.9rem; color: var(--text-gray);">"Good machine, but fuel tank was half
                            empty when delivered. Otherwise, everything fine."</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div class="modal" id="profileModal">
        <div class="modal-content" style="max-width: 650px; border-radius: 30px;">
            <button class="close-modal" onclick="closeModal('profileModal')" style="top: 2rem; right: 2rem;">
                <span class="material-icons-outlined">close</span>
            </button>
            <div class="modal-header" style="border-bottom: none; padding: 3rem 3rem 1rem;">
                <h2 class="modal-title"
                    style="font-family: var(--font-serif); font-size: 2.5rem; color: #1a1a2e; font-weight: 700;">Profile
                    Settings</h2>
            </div>
            <div class="modal-body" style="padding: 0 3rem 3rem;">
                <form>
                    <!-- Avatar Upload Section -->
                    <div style="display: flex; justify-content: center; margin-bottom: 2.5rem;">
                        <div
                            style="position: relative; width: 180px; height: 180px; border-radius: 50%; border: 3px solid var(--primary-blue); padding: 5px;">
                            <div id="profile-avatar-preview"
                                style="width: 100%; height: 100%; border-radius: 50%; background: #f8fafc; display: flex; align-items: center; justify-content: center; overflow: hidden; background-size: cover; background-position: center;">
                                <span class="material-icons-outlined"
                                    style="font-size: 5rem; color: #e2e8f0;">person</span>
                            </div>
                            <label for="avatar-upload"
                                style="position: absolute; bottom: 8px; right: 8px; width: 45px; height: 45px; background: var(--primary-blue); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; cursor: pointer; border: 3px solid white; box-shadow: 0 4px 10px rgba(0, 119, 182, 0.3); transition: all 0.3s ease;">
                                <span class="material-icons-outlined" style="font-size: 20px;">photo_camera</span>
                                <input type="file" id="avatar-upload" style="display: none;" accept="image/*"
                                    onchange="previewAvatar(this)">
                            </label>
                        </div>
                    </div>

                    <div class="form-row" style="margin-bottom: 1.5rem;">
                        <div class="form-group">
                            <label
                                style="font-size: 0.9rem; font-weight: 600; color: #64748b; margin-bottom: 0.75rem;">Full
                                Name</label>
                            <input type="text" value="ALEN CHACKO"
                                style="background: #f8fafc; border: 1px solid #e2e8f0; padding: 1rem; border-radius: 12px; font-weight: 500;">
                        </div>
                        <div class="form-group">
                            <label
                                style="font-size: 0.9rem; font-weight: 600; color: #64748b; margin-bottom: 0.75rem;">Email
                                Address</label>
                            <input type="email" value="alenchacko2028@mca.ajce.in"
                                style="background: #f8fafc; border: 1px solid #e2e8f0; padding: 1rem; border-radius: 12px; font-weight: 500;">
                        </div>
                    </div>

                    <div class="form-group" style="position: relative; margin-bottom: 2.5rem;">
                        <label
                            style="font-size: 0.9rem; font-weight: 600; color: #64748b; margin-bottom: 0.75rem;">Change
                            Password (leave blank to keep current)</label>
                        <div style="position: relative;">
                            <input type="password" value="********"
                                style="background: #eff6ff; border: 1px solid #dbeafe; padding: 1rem; border-radius: 12px; width: 100%; padding-right: 3.5rem;">
                            <span class="material-icons-outlined"
                                style="position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); color: #94a3b8; cursor: pointer;"
                                onclick="togglePasswordVisibility(this)">visibility</span>
                        </div>
                    </div>

                    <button type="button" class="btn"
                        style="width: 100%; background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue)); color: white; padding: 1.25rem; border-radius: 15px; font-weight: 700; font-size: 1rem; display: flex; align-items: center; justify-content: center; gap: 0.75rem; text-transform: uppercase; letter-spacing: 0.5px; box-shadow: 0 10px 20px rgba(0, 119, 182, 0.2); border: none; cursor: pointer; transition: all 0.3s ease;"
                        onclick="alert('Profile Updated Successfully!')">
                        <span class="material-icons-outlined">save</span>
                        UPDATE PROFILE DETAILS
                    </button>

                    <p style="text-align: center; margin-top: 1.5rem; color: #94a3b8; font-size: 0.9rem;">Changes will
                        be saved permanently to your account.</p>
                </form>
            </div>
        </div>
    </div>

    <!-- View Equipment Details Modal -->
    <div class="modal" id="viewEquipmentDetailsModal">
        <div class="modal-content" style="max-width: 800px; border-radius: 24px; padding: 0; overflow: hidden;">
            <button class="close-modal" onclick="closeModal('viewEquipmentDetailsModal')"
                style="z-index: 10; background: rgba(255,255,255,0.8); border-radius: 50%; padding: 5px;">
                <span class="material-icons-outlined">close</span>
            </button>

            <div style="display: grid; grid-template-columns: 1fr 1fr; min-height: 500px;">
                <!-- Left: Image Section -->
                <div style="background: #f1f5f9; position: relative;">
                    <img id="viewEqImage" src="" alt="Equipment Image"
                        style="width: 100%; height: 100%; object-fit: cover; min-height: 300px;">
                    <div id="viewEqStatusBadge"
                        style="position: absolute; top: 20px; left: 20px; padding: 6px 16px; border-radius: 50px; color: white; font-weight: 600; text-transform: uppercase; font-size: 0.85rem; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
                        AVAILABLE
                    </div>
                </div>

                <!-- Right: Details Section -->
                <div
                    style="padding: 2.5rem; display: flex; flex-direction: column; overflow-y: auto; max-height: 80vh;">
                    <div style="margin-bottom: 1.5rem;">
                        <h2 id="viewEqName"
                            style="font-family: var(--font-serif); font-size: 2rem; color: var(--text-dark); line-height: 1.2; margin-bottom: 0.5rem;">
                            Equipment Name</h2>
                        <div
                            style="display: flex; align-items: center; gap: 1rem; color: var(--text-gray); font-size: 0.9rem;">
                            <span style="display: flex; align-items: center; gap: 0.25rem;">
                                <span class="material-icons-outlined" style="font-size: 1.1rem;">category</span>
                                <span id="viewEqCategory">Category</span>
                            </span>
                            <span style="display: flex; align-items: center; gap: 0.25rem;">
                                <span class="material-icons-outlined" style="font-size: 1.1rem;">location_on</span>
                                <span id="viewEqLocation">Location</span>
                            </span>
                        </div>
                    </div>

                    <div style="margin-bottom: 2rem;">
                        <div
                            style="display: flex; align-items: baseline; gap: 0.25rem; color: var(--primary-blue); margin-bottom: 0.5rem;">
                            <span style="font-size: 1.25rem; font-weight: 600;">â‚¹</span>
                            <span id="viewEqPrice" style="font-size: 2.5rem; font-weight: 700;">0</span>
                            <span style="color: var(--text-gray); font-weight: 400; font-size: 0.9rem;">/ day</span>
                        </div>
                    </div>

                    <div style="margin-bottom: 2rem;">
                        <h4
                            style="font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; color: var(--text-light); margin-bottom: 0.75rem;">
                            Description</h4>
                        <p id="viewEqDescription"
                            style="color: var(--text-gray); line-height: 1.6; font-size: 0.95rem;">
                            No description provided.
                        </p>
                    </div>

                    <div style="background: #f8fafc; border-radius: 16px; padding: 1.5rem; margin-top: auto;">
                        <h4
                            style="font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; color: var(--text-light); margin-bottom: 1rem;">
                            Specifications</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div>
                                <div style="font-size: 0.75rem; color: var(--text-light);">Model</div>
                                <div id="viewEqModel" style="font-weight: 600; color: var(--text-dark);">--</div>
                            </div>
                            <div>
                                <div style="font-size: 0.75rem; color: var(--text-light);">Year</div>
                                <div id="viewEqYear" style="font-weight: 600; color: var(--text-dark);">--</div>
                            </div>
                            <div>
                                <div style="font-size: 0.75rem; color: var(--text-light);">Fuel Type</div>
                                <div id="viewEqFuel" style="font-weight: 600; color: var(--text-dark);">--</div>
                            </div>
                            <div>
                                <div style="font-size: 0.75rem; color: var(--text-light);">Capacity</div>
                                <div id="viewEqCapacity" style="font-weight: 600; color: var(--text-dark);">--</div>
                            </div>
                        </div>
                    </div>


                    <button id="viewEqDeleteBtn" class="btn"
                        style="margin-top: 1rem; width: 100%; background: rgba(239, 68, 68, 0.1); color: var(--error); border: 1px solid rgba(239, 68, 68, 0.3); padding: 1rem; border-radius: 12px; font-weight: 700; display: flex; align-items: center; justify-content: center; gap: 0.5rem; transition: all 0.3s; cursor: pointer;">
                        <span class="material-icons-outlined">delete_forever</span>
                        Delete Listing
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content" style="max-width: 600px;">
            <button class="close-modal" onclick="closeModal('settingsModal')">
                <span class="material-icons-outlined">close</span>
            </button>
            <div class="modal-header">
                <h2 class="modal-title">âš™ï¸ Settings</h2>
                <p class="modal-subtitle">Manage notifications and account security</p>
            </div>
            <div class="modal-body">
                <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-weight: 600;">Email Notifications</div>
                            <div style="font-size: 0.8rem; color: var(--text-gray);">Receive alerts for new bookings
                            </div>
                        </div>
                        <input type="checkbox" checked style="width: auto;">
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-weight: 600;">SMS Alerts</div>
                            <div style="font-size: 0.8rem; color: var(--text-gray);">Instant updates on mobile</div>
                        </div>
                        <input type="checkbox" checked style="width: auto;">
                    </div>
                    <hr style="border: 0; border-top: 1px solid #e5e7eb;">
                    <button class="btn btn-secondary" style="color: var(--error);"
                        onclick="alert('Password reset link sent!')">Change Password</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal" id="deleteConfirmationModal">
        <div class="modal-content" style="max-width: 450px; text-align: center; padding: 2.5rem;">
            <button class="close-modal" onclick="closeModal('deleteConfirmationModal')">
                <span class="material-icons-outlined">close</span>
            </button>
            <div
                style="width: 80px; height: 80px; border-radius: 50%; background: rgba(239, 68, 68, 0.1); display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem;">
                <span class="material-icons-outlined" style="font-size: 3rem; color: var(--error);">delete</span>
            </div>
            <h2 class="modal-title" style="font-size: 1.5rem; margin-bottom: 1rem;">Delete Equipment?</h2>
            <p class="modal-subtitle" style="margin-bottom: 2rem; line-height: 1.6;">Are you sure you want to delete
                this equipment listing permanently? This action cannot be undone.</p>
            <div style="display: flex; gap: 1rem; justify-content: center;">
                <button class="btn" onclick="closeModal('deleteConfirmationModal')"
                    style="background: #f1f5f9; color: var(--text-dark); flex: 1; padding: 1rem;">Cancel</button>
                <button class="btn" id="confirmDeleteBtn" onclick="confirmDelete()"
                    style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white; flex: 1; padding: 1rem; box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);">Yes,
                    Delete</button>
            </div>
        </div>
    </div>

    <style>
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--white);
            border-radius: 24px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            padding: 2rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .modal-title {
            font-family: var(--font-serif);
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
        }

        .modal-subtitle {
            color: var(--text-gray);
        }

        .modal-body {
            padding: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-dark);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .modal-footer {
            padding: 1.5rem 2rem;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue));
            color: var(--white);
        }

        .btn-secondary {
            background: #f3f4f6;
            color: var(--text-gray);
        }

        .close-modal {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #f3f4f6;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>

    <!-- Mobile Toggle Button -->
    <button class="mobile-toggle" id="mobileToggle">
        <span class="material-icons-outlined">menu</span>
    </button>

    <script>
        // Mobile Sidebar Toggle
        const sidebar = document.getElementById('sidebar');
        const mobileToggle = document.getElementById('mobileToggle');

        mobileToggle.addEventListener('click', () => {
            sidebar.classList.toggle('active');
            const icon = mobileToggle.querySelector('.material-icons-outlined');
            icon.textContent = sidebar.classList.contains('active') ? 'close' : 'menu';
        });

        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', (e) => {
            if (window.innerWidth <= 992) {
                if (!sidebar.contains(e.target) && !mobileToggle.contains(e.target)) {
                    sidebar.classList.remove('active');
                    mobileToggle.querySelector('.material-icons-outlined').textContent = 'menu';
                }
            }
        });

        // Logout function
        function logout() {
            if (confirm('Are you sure you want to sign out?')) {
                // Clear user data from localStorage
                localStorage.removeItem('agrohub_user');
                // Redirect to login page
                window.location.href = 'login-owner.html';
            }
        }

        // Load user info from localStorage
        function loadUserInfo() {
            const userDataStr = localStorage.getItem('agrohub_user');
            if (userDataStr) {
                const userData = JSON.parse(userDataStr);
                const userName = userData.name || userData.email || 'User';
                const firstName = userName.split(' ')[0].split('@')[0]; // Get first name or email prefix

                // Get initials (max 2 characters)
                let initials = '';
                if (userData.name) {
                    const nameParts = userData.name.split(' ');
                    initials = nameParts[0].charAt(0).toUpperCase();
                    if (nameParts.length > 1) {
                        initials += nameParts[nameParts.length - 1].charAt(0).toUpperCase();
                    }
                } else {
                    initials = firstName.substring(0, 2).toUpperCase();
                }

                // Update DOM elements
                document.getElementById('user-avatar').textContent = initials;
                document.getElementById('user-name').innerHTML = userName + ' <span class="badge-verified">âœ“ Verified</span>';
                document.getElementById('welcome-message').textContent = 'Welcome back, ' + firstName + '! ðŸ‘‹';

                // Update Profile Modal fields
                const profileNameInput = document.querySelector('#profileModal input[type="text"]');
                const profileEmailInput = document.querySelector('#profileModal input[type="email"]');
                if (profileNameInput) profileNameInput.value = userName;
                if (profileEmailInput && userData.email) profileEmailInput.value = userData.email;

                // If user has a Google profile picture, use it
                if (userData.picture) {
                    const avatarEl = document.getElementById('user-avatar');
                    avatarEl.style.backgroundImage = 'url(' + userData.picture + ')';
                    avatarEl.style.backgroundSize = 'cover';
                    avatarEl.style.backgroundPosition = 'center';
                    avatarEl.textContent = '';

                    const modalAvatar = document.getElementById('profile-avatar-preview');
                    if (modalAvatar) {
                        modalAvatar.style.backgroundImage = 'url(' + userData.picture + ')';
                        modalAvatar.innerHTML = '';
                    }
                }
            }
        }

        // Load owner's equipment from database
        async function loadOwnerEquipment() {
            const grid = document.getElementById('ownerEquipmentGrid');
            if (!grid) return;

            try {
                // Get owner info from localStorage
                const userData = JSON.parse(localStorage.getItem('agrohub_user') || '{}');
                const ownerId = userData.id || 1;

                // Fetch equipment filtered by owner_id
                const response = await fetch(`php/get_equipment.php?owner_id=${ownerId}`);
                const data = await response.json();

                if (data.success && data.equipment && data.equipment.length > 0) {
                    // Update Active Listings stat
                    const activeListingsEl = document.getElementById('activeListings');
                    if (activeListingsEl) {
                        activeListingsEl.textContent = data.equipment.length;
                    }

                    grid.innerHTML = data.equipment.map(item => `
                        <div class="equipment-card" style="background: var(--white); border-radius: 20px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.05); transition: all 0.3s ease;">
                            <div style="height: 180px; position: relative; background: linear-gradient(135deg, #f1f5f9, #e2e8f0); display: flex; align-items: center; justify-content: center;">
                                ${item.image_url ? `<img src="${item.image_url}" style="width:100%; height:100%; object-fit:cover; position: absolute; top: 0; left: 0;" onerror="this.style.display='none'; this.parentElement.querySelector('.placeholder-icon').style.display='flex';">` : ''}
                                <span class="material-icons-outlined placeholder-icon" style="font-size: 4rem; color: var(--text-light); ${item.image_url ? 'display: none;' : 'display: flex;'}">agriculture</span>
                                <span style="position: absolute; top: 12px; left: 12px; padding: 0.25rem 0.75rem; border-radius: 50px; font-size: 0.75rem; background: ${item.availability_status === 'available' ? 'rgba(34,197,94,0.2)' : 'rgba(245,158,11,0.2)'}; color: ${item.availability_status === 'available' ? 'var(--success)' : 'var(--accent-orange)'}; font-weight: 600; backdrop-filter: blur(4px);">
                                    ${item.availability_status === 'available' ? 'Available' : item.availability_status === 'booked' ? 'Booked' : 'Maintenance'}
                                </span>
                            </div>
                        <div style="padding: 1.25rem;">
                            <h4 style="font-size: 1.1rem; margin-bottom: 0.25rem;">${item.equipment_name}</h4>
                            <p style="font-size: 0.85rem; color: var(--text-gray); margin-bottom: 1rem;">${item.description.substring(0, 50)}...</p>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div style="font-weight: 700; color: var(--primary-blue);">â‚¹${parseFloat(item.price_per_day).toLocaleString()} <span style="font-weight: 400; font-size: 0.8rem; color: var(--text-gray);">/day</span></div>
                                <div style="display: flex; gap: 0.5rem;">
                                    <button onclick="alert('Edit functionality coming soon!')" style="width: 35px; height: 35px; border-radius: 8px; border: 1px solid #e5e7eb; background: var(--white); cursor: pointer;">
                                        <span class="material-icons-outlined" style="font-size: 18px;">edit</span>
                                    </button>
                                    <button onclick="alert('View details for: ${item.equipment_name}')" style="width: 35px; height: 35px; border-radius: 8px; border: 1px solid #e5e7eb; background: var(--white); cursor: pointer;">
                                        <span class="material-icons-outlined" style="font-size: 18px;">visibility</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        </div >
                        `).join('');
                } else {
                    // Update Active Listings to 0
                    const activeListingsEl = document.getElementById('activeListings');
                    if (activeListingsEl) {
                        activeListingsEl.textContent = '0';
                    }

                    grid.innerHTML = `
                        < div style = "grid-column: 1/-1; text-align: center; padding: 3rem; background: white; border-radius: 20px; border: 2px dashed #e5e7eb;" >
                            <span class="material-icons-outlined" style="font-size: 4rem; color: var(--text-light);">inventory_2</span>
                            <h3 style="margin: 1rem 0; color: var(--text-dark);">No Equipment Listed Yet</h3>
                            <p style="color: var(--text-gray); margin-bottom: 1.5rem;">Start by adding your first equipment to begin receiving rental requests</p>
                            <button onclick="openModal('addEquipmentModal')" style="padding: 0.75rem 1.5rem; background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue)); color: white; border: none; border-radius: 12px; cursor: pointer; display: inline-flex; align-items: center; gap: 0.5rem;">
                                <span class="material-icons-outlined">add</span>
                                Add Your First Equipment
                            </button>
                        </div >
                        `;
                }
            } catch (error) {
                console.error('Error loading equipment:', error);
                grid.innerHTML = `
                        < div style = "grid-column: 1/-1; text-align: center; padding: 2rem; background: rgba(239, 68, 68, 0.1); border-radius: 20px; border: 2px solid var(--error);" >
                        <span class="material-icons-outlined" style="font-size: 3rem; color: var(--error);">error_outline</span>
                        <p style="margin-top: 1rem; color: var(--error);">Failed to load equipment. Please refresh the page.</p>
                    </div >
                        `;
            }
        }

        // Load recent bookings for dashboard display
        async function loadRecentBookings() {
            const container = document.getElementById('recentBookingsList');
            if (!container) return;

            try {
                // Get owner info from localStorage
                const userData = JSON.parse(localStorage.getItem('agrohub_user') || '{}');
                const ownerId = userData.id || 0;

                if (!ownerId) {
                    container.innerHTML = `
                        <div style="padding: 2rem; text-align: center; color: var(--text-light);">
                            <span class="material-icons-outlined" style="font-size: 2rem;">login</span>
                            <p style="margin-top: 0.5rem;">Please log in to view bookings</p>
                        </div>
                    `;
                    return;
                }

                const response = await fetch(`php/get_bookings.php?owner_id=${ownerId}`);
                const data = await response.json();

                if (data.success && data.bookings && data.bookings.length > 0) {
                    // Show only the 3 most recent bookings
                    const recentBookings = data.bookings.slice(0, 3);

                    container.innerHTML = recentBookings.map(booking => {
                        const initials = booking.farmer_name.split(' ').map(n => n[0]).join('').toUpperCase();
                        const statusColor = booking.status === 'approved' || booking.status === 'completed' ?
                            'rgba(34,197,94,0.1)' : booking.status === 'pending' ?
                                'rgba(245,158,11,0.1)' : 'rgba(239,68,68,0.1)';
                        const statusTextColor = booking.status === 'approved' || booking.status === 'completed' ?
                            'var(--success)' : booking.status === 'pending' ?
                                'var(--warning)' : 'var(--error)';
                        const statusText = booking.status.charAt(0).toUpperCase() + booking.status.slice(1);

                        return `
                            <div class="booking-item"
                                style="display: flex; align-items: center; gap: 1rem; padding: 1rem; border: 1px solid #f1f5f9; border-radius: 16px;">
                                <div
                                    style="width: 45px; height: 45px; border-radius: 12px; background: var(--light-blue); color: var(--primary-blue); display: flex; align-items: center; justify-content: center; font-weight: 700;">
                                    ${initials}</div>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600;">${booking.farmer_name}</div>
                                    <div style="font-size: 0.8rem; color: var(--text-gray);">${booking.equipment_name}</div>
                                </div>
                                <div
                                    style="padding: 0.25rem 0.75rem; border-radius: 50px; font-size: 0.75rem; background: ${statusColor}; color: ${statusTextColor};">
                                    ${statusText}</div>
                            </div>
                        `;
                    }).join('');
                } else {
                    container.innerHTML = `
                        <div style="padding: 2rem; text-align: center; color: var(--text-light);">
                            <span class="material-icons-outlined" style="font-size: 2.5rem;">event_note</span>
                            <p style="margin-top: 0.5rem;">No bookings yet</p>
                            <p style="font-size: 0.8rem; margin-top: 0.25rem;">Bookings will appear here when farmers rent your equipment</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading recent bookings:', error);
                container.innerHTML = `
                    <div style="padding: 2rem; text-align: center; color: var(--error);">
                        <span class="material-icons-outlined" style="font-size: 2rem;">error_outline</span>
                        <p style="margin-top: 0.5rem;">Failed to load bookings</p>
                    </div>
                `;
            }
        }

        // Update Sidebar Badge Counts
        async function updateSidebarBadges() {
            try {
                // Get owner info from localStorage
                const userData = JSON.parse(localStorage.getItem('agrohub_user') || '{}');
                const ownerId = userData.id || 0;

                if (!ownerId) return;

                // Fetch equipment count
                const equipmentResponse = await fetch(`php/get_equipment.php?owner_id=${ownerId}`);
                const equipmentData = await equipmentResponse.json();
                const equipmentCount = equipmentData.success && equipmentData.equipment ? equipmentData.equipment.length : 0;

                const equipmentBadge = document.getElementById('equipmentCountBadge');
                if (equipmentBadge) {
                    equipmentBadge.textContent = equipmentCount;
                    equipmentBadge.style.display = equipmentCount > 0 ? 'inline-block' : 'none';
                }

                // Fetch booking requests count (pending bookings)
                const bookingsResponse = await fetch(`php/get_bookings.php?owner_id=${ownerId}&status=pending`);
                const bookingsData = await bookingsResponse.json();
                const pendingCount = bookingsData.success && bookingsData.bookings ? bookingsData.bookings.length : 0;

                const bookingsBadge = document.getElementById('bookingRequestsBadge');
                if (bookingsBadge) {
                    bookingsBadge.textContent = pendingCount;
                    bookingsBadge.style.display = pendingCount > 0 ? 'inline-block' : 'none';
                }

                // Fetch active rentals count (approved bookings)
                const activeResponse = await fetch(`php/get_bookings.php?owner_id=${ownerId}&status=approved`);
                const activeData = await activeResponse.json();
                const activeCount = activeData.success && activeData.bookings ? activeData.bookings.length : 0;

                const activeBadge = document.getElementById('activeRentalsBadge');
                if (activeBadge) {
                    activeBadge.textContent = activeCount;
                    activeBadge.style.display = activeCount > 0 ? 'inline-block' : 'none';
                }

                // Agreements badge remains hidden as there's no agreements system yet
                const agreementsBadge = document.getElementById('agreementsBadge');
                if (agreementsBadge) {
                    agreementsBadge.style.display = 'none';
                }

            } catch (error) {
                console.error('Error updating sidebar badges:', error);
            }
        }

        // Run on page load
        window.addEventListener('DOMContentLoaded', () => {
            loadUserInfo();
            loadOwnerEquipment();
            loadRecentBookings();
            updateSidebarBadges();
        });

        // Load booking requests for the owner
        async function loadBookingRequests() {
            const tbody = document.getElementById('bookingsTableBody');
            if (!tbody) return;

            try {
                // âš ï¸ TEST MODE - Set to false in production
                const TEST_MODE = true;

                // Get owner info from localStorage
                let userData = JSON.parse(localStorage.getItem('agrohub_user') || '{}');

                // If TEST_MODE and no user data, use test owner
                if (TEST_MODE && !userData.id) {
                    console.log('TEST MODE: Using test owner account (ID 5)');
                    userData = { id: 5, name: 'Test Owner', user_type: 'owner' };
                }

                const ownerId = userData.id || 5;


                const response = await fetch(`php/get_bookings.php?owner_id=${ownerId}&status=pending`);

                const data = await response.json();

                if (data.success && data.bookings && data.bookings.length > 0) {
                    tbody.innerHTML = data.bookings.map(booking => `
                        <tr style="border-bottom: 1px solid #f1f5f9;">
                            <td style="padding: 1rem;">
                                <div style="font-weight: 600;">${booking.farmer_name || 'Anonymous Farmer'}</div>
                                <div style="font-size: 0.75rem; color: var(--text-gray);">â­ ${booking.farmer_rating || '4.0'} Rating</div>
                            </td>
                            <td style="padding: 1rem;">${booking.equipment_name}</td>
                            <td style="padding: 1rem;">${booking.start_date} - ${booking.end_date} (${booking.duration} days)</td>
                            <td style="padding: 1rem; font-weight: 700; color: var(--success);">â‚¹${parseFloat(booking.total_amount).toLocaleString()}</td>
                            <td style="padding: 1rem;">
                                ${booking.status === 'pending' ? `
                                    <button onclick="approveBooking(${booking.id})"
                                        style="background: var(--success); color: white; border: none; padding: 0.4rem 0.8rem; border-radius: 6px; cursor: pointer; margin-right: 0.5rem;">Approve</button>
                                    <button onclick="rejectBooking(${booking.id})"
                                        style="background: var(--error); color: white; border: none; padding: 0.4rem 0.8rem; border-radius: 6px; cursor: pointer;">Reject</button>
                                ` : `
                                    <span style="padding: 0.4rem 0.8rem; border-radius: 6px; font-size: 0.75rem; 
                                        background: ${booking.status === 'approved' ? 'rgba(34,197,94,0.1)' : 'rgba(239,68,68,0.1)'}; 
                                        color: ${booking.status === 'approved' ? 'var(--success)' : 'var(--error)'}; font-weight: 600;">
                                        ${booking.status.charAt(0).toUpperCase() + booking.status.slice(1)}
                                    </span>
                                `}
                            </td>
                        </tr>
                        `).join('');
                } else {
                    tbody.innerHTML = `
                        < tr >
                        <td colspan="5" style="padding: 3rem; text-align: center;">
                            <span class="material-icons-outlined" style="font-size: 4rem; color: var(--text-light);">event_busy</span>
                            <h3 style="margin: 1rem 0; color: var(--text-dark);">No Booking Requests Yet</h3>
                            <p style="color: var(--text-gray);">When farmers request to rent your equipment, you'll see them here.</p>
                        </td>
                        </tr >
                        `;
                }
            } catch (error) {
                console.error('Error loading bookings:', error);
                tbody.innerHTML = `
                        < tr >
                        <td colspan="5" style="padding: 3rem; text-align: center;">
                            <span class="material-icons-outlined" style="font-size: 3rem; color: var(--error);">error_outline</span>
                            <p style="margin-top: 1rem; color: var(--error);">Failed to load booking requests. Please try again.</p>
                        </td>
                    </tr >
                        `;
            }
        }

        // Approve booking
        async function approveBooking(bookingId) {
            if (!confirm('Are you sure you want to approve this booking request?')) return;

            try {
                const response = await fetch('php/update_booking.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ booking_id: bookingId, status: 'approved' })
                });

                const data = await response.json();
                if (data.success) {
                    showNotification('âœ… Booking approved successfully!', 'success');
                    loadBookingRequests(); // Reload the list
                    updateSidebarBadges(); // Update badge counts
                } else {
                    showNotification('âŒ Failed to approve booking: ' + data.error, 'error');
                }
            } catch (error) {
                showNotification('âŒ Network error: Could not approve booking', 'error');
            }
        }

        // Reject booking
        async function rejectBooking(bookingId) {
            if (!confirm('Are you sure you want to reject this booking request?')) return;

            try {
                const response = await fetch('php/update_booking.php', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ booking_id: bookingId, status: 'rejected' })
                });

                const data = await response.json();
                if (data.success) {
                    showNotification('â„¹ï¸ Booking rejected', 'error');
                    loadBookingRequests(); // Reload the list
                    updateSidebarBadges(); // Update badge counts
                } else {
                    showNotification('âŒ Failed to reject booking: ' + data.error, 'error');
                }
            } catch (error) {
                showNotification('âŒ Network error: Could not reject booking', 'error');
            }
        }

        // Load active rentals (approved bookings)
        async function loadActiveRentals() {
            const tbody = document.getElementById('activeRentalsTableBody');
            if (!tbody) return;

            try {
                // Get owner info from localStorage
                const userData = JSON.parse(localStorage.getItem('agrohub_user') || '{}');
                const ownerId = userData.id || 1;

                const response = await fetch(`php/get_bookings.php?owner_id=${ownerId}`);
                const data = await response.json();

                let activeRentals = [];
                if (data.success && data.bookings) {
                    activeRentals = data.bookings.filter(b =>
                        ['approved', 'paid', 'active', 'confirmed'].includes(b.status) ||
                        (['pending'].includes(b.status) && b.payment_status === 'paid')
                    );
                }

                if (activeRentals.length > 0) {
                    tbody.innerHTML = activeRentals.map(rental => {
                        const returnDate = new Date(rental.end_date);
                        const formattedDate = returnDate.toLocaleDateString('en-US', {
                            month: 'short',
                            day: 'numeric',
                            year: 'numeric'
                        });

                        return `
                        <tr style="border-bottom: 1px solid #f1f5f9;">
                            <td style="padding: 1rem; font-weight: 600;">${rental.equipment_name}</td>
                            <td style="padding: 1rem;">${rental.farmer_name}</td>
                            <td style="padding: 1rem;">${formattedDate}</td>
                            <td style="padding: 1rem;">
                                <span class="badge success" style="padding: 0.25rem 0.75rem; border-radius: 50px; font-size: 0.75rem; background: rgba(34,197,94,0.1); color: var(--success);">
                                    ${rental.equipment_condition || 'Good'}
                                </span>
                            </td>
                            <td style="padding: 1rem;">
                                <button class="btn btn-secondary"
                                    onclick="alert('Messaging feature coming soon! You can contact ${rental.farmer_name}')"
                                    style="padding: 0.5rem 1rem; border-radius: 8px; border: 1px solid #e5e7eb; background: var(--white); cursor: pointer;">
                                    Message
                                </button>
                            </td>
                        </tr>
                        `;
                    }).join('');
                } else {
                    tbody.innerHTML = `
                        <tr>
                        <td colspan="5" style="padding: 3rem; text-align: center;">
                            <span class="material-icons-outlined" style="font-size: 4rem; color: var(--text-light);">inventory_2</span>
                            <h3 style="margin: 1rem 0; color: var(--text-dark);">No Active Rentals</h3>
                            <p style="color: var(--text-gray);">When you approve booking requests, they will appear here as active rentals.</p>
                        </td>
                        </tr>
                        `;
                }
            } catch (error) {
                console.error('Error loading active rentals:', error);
                tbody.innerHTML = `
                        < tr >
                        <td colspan="5" style="padding: 3rem; text-align: center;">
                            <span class="material-icons-outlined" style="font-size: 3rem; color: var(--error);">error_outline</span>
                            <p style="margin-top: 1rem; color: var(--error);">Failed to load active rentals. Please try again.</p>
                        </td>
                    </tr >
                        `;
            }
        }


        // Active nav item handler
        const navItems = document.querySelectorAll('.nav-item');
        navItems.forEach(item => {
            item.addEventListener('click', function (e) {
                // Remove active class from all
                navItems.forEach(nav => nav.classList.remove('active'));
                // Add to clicked
                this.classList.add('active');
            });
        });

        // Search functionality (placeholder)
        const searchInput = document.querySelector('.search-box input');
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const query = e.target.value.trim();
                if (query) {
                    console.log('Searching for:', query);
                    // Add your search logic here
                }
            }
        });

        // Stats counter animation
        function animateCounters() {
            const counters = document.querySelectorAll('.stat-value');
            counters.forEach(counter => {
                const text = counter.textContent;
                // Check if it's a currency value
                if (text.includes('â‚¹')) {
                    const value = parseInt(text.replace(/[â‚¹,]/g, ''));
                    let current = 0;
                    const increment = value / 30;
                    const timer = setInterval(() => {
                        current += increment;
                        if (current >= value) {
                            counter.textContent = 'â‚¹' + value.toLocaleString('en-IN');
                            clearInterval(timer);
                        } else {
                            counter.textContent = 'â‚¹' + Math.floor(current).toLocaleString('en-IN');
                        }
                    }, 50);
                } else if (text.includes('.')) {
                    // Decimal value (rating)
                    const value = parseFloat(text);
                    let current = 0;
                    const increment = value / 30;
                    const timer = setInterval(() => {
                        current += increment;
                        if (current >= value) {
                            counter.textContent = value.toFixed(1);
                            clearInterval(timer);
                        } else {
                            counter.textContent = current.toFixed(1);
                        }
                    }, 50);
                } else {
                    // Regular number
                    const target = parseInt(text);
                    let current = 0;
                    const increment = target / 30;
                    const timer = setInterval(() => {
                        current += increment;
                        if (current >= target) {
                            counter.textContent = target;
                            clearInterval(timer);
                        } else {
                            counter.textContent = Math.floor(current);
                        }
                    }, 50);
                }
            });
        }

        // Animate earnings amount
        function animateEarnings() {
            const earningsEl = document.querySelector('.earnings-amount');
            if (earningsEl) {
                const value = parseInt(earningsEl.textContent.replace(/[â‚¹,]/g, ''));
                let current = 0;
                const increment = value / 30;
                const timer = setInterval(() => {
                    current += increment;
                    if (current >= value) {
                        earningsEl.textContent = 'â‚¹' + value.toLocaleString('en-IN');
                        clearInterval(timer);
                    } else {
                        earningsEl.textContent = 'â‚¹' + Math.floor(current).toLocaleString('en-IN');
                    }
                }, 50);
            }
        }

        // Run counter animation on page load
        window.addEventListener('load', () => {
            animateCounters();
            animateEarnings();
        });

        // Service card click handlers
        const serviceCards = document.querySelectorAll('.service-card');
        serviceCards.forEach(card => {
            card.addEventListener('click', function (e) {
                e.preventDefault();
                const serviceName = this.querySelector('h3').textContent;
                console.log('Service clicked:', serviceName);
                // Add your navigation logic here
            });
        });

        // Equipment action buttons
        const equipmentActions = document.querySelectorAll('.equipment-action-btn');
        equipmentActions.forEach(btn => {
            btn.addEventListener('click', function (e) {
                e.stopPropagation();
                const action = this.dataset.tooltip;
                const equipmentName = this.closest('.equipment-card').querySelector('h4').textContent;
                console.log(`${action} action on: ${equipmentName}`);
            });
        });

        // Load Earnings Data  
        async function loadEarningsData() {
            try {
                // Get owner info from localStorage
                const userData = JSON.parse(localStorage.getItem('agrohub_user') || '{}');
                const ownerId = userData.id || 0;

                if (!ownerId) {
                    console.error('Owner ID not found');
                    return;
                }

                const response = await fetch(`php/get_earnings.php?owner_id=${ownerId}`);
                const data = await response.json();

                if (data.success) {
                    // Update wallet balance
                    const walletBalanceEl = document.querySelector('#earningsModal .modal-body > div > div:nth-child(1) > div:nth-child(2)');
                    if (walletBalanceEl) {
                        walletBalanceEl.textContent = 'â‚¹' + data.earnings.wallet_balance.toLocaleString('en-IN');
                    }

                    // Update pending payouts
                    const pendingPayoutsEl = document.querySelector('#earningsModal .modal-body > div > div:nth-child(2) > div:nth-child(2)');
                    if (pendingPayoutsEl) {
                        pendingPayoutsEl.textContent = 'â‚¹' + data.earnings.pending_payouts.toLocaleString('en-IN');
                    }

                    console.log('Earnings data loaded successfully:', data.earnings);
                } else {
                    console.error('Failed to load earnings:', data.error);
                }
            } catch (error) {
                console.error('Error loading earnings data:', error);
            }
        }

        // Load Rental History
        async function loadRentalHistory() {
            const tbody = document.getElementById('rentalHistoryTableBody');
            if (!tbody) return;

            try {
                // Get owner info from localStorage
                const userData = JSON.parse(localStorage.getItem('agrohub_user') || '{}');
                const ownerId = userData.id || 0;

                if (!ownerId) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="5" style="padding: 3rem; text-align: center;">
                                <span class="material-icons-outlined" style="font-size: 3rem; color: var(--text-light);">login</span>
                                <p style="margin-top: 1rem; color: var(--text-gray);">Please log in to view rental history</p>
                            </td>
                        </tr>
                    `;
                    return;
                }

                const response = await fetch(`php/get_bookings.php?owner_id=${ownerId}&status=completed`);
                const data = await response.json();

                if (data.success && data.bookings && data.bookings.length > 0) {
                    tbody.innerHTML = data.bookings.map(rental => {
                        const startDate = new Date(rental.start_date);
                        const endDate = new Date(rental.end_date);
                        const formattedDates = `${startDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} - ${endDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}`;

                        return `
                            <tr style="border-bottom: 1px solid #f1f5f9;">
                                <td style="padding: 1rem;">${rental.equipment_name}</td>
                                <td style="padding: 1rem;">${rental.farmer_name}</td>
                                <td style="padding: 1rem;">${formattedDates}</td>
                                <td style="padding: 1rem;">
                                    <span class="booking-status confirmed" style="padding: 0.25rem 0.75rem; border-radius: 50px; font-size: 0.75rem; background: rgba(34,197,94,0.1); color: var(--success);">
                                        Completed
                                    </span>
                                </td>
                                <td style="padding: 1rem; font-weight: 700;">â‚¹${parseFloat(rental.total_amount).toLocaleString('en-IN')}</td>
                            </tr>
                        `;
                    }).join('');
                } else {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="5" style="padding: 3rem; text-align: center;">
                                <span class="material-icons-outlined" style="font-size: 4rem; color: var(--text-light);">history</span>
                                <h3 style="margin: 1rem 0; color: var(--text-dark);">No Rental History</h3>
                                <p style="color: var(--text-gray);">Your completed rentals will appear here once farmers rent and return your equipment.</p>
                            </td>
                        </tr>
                    `;
                }
            } catch (error) {
                console.error('Error loading rental history:', error);
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" style="padding: 3rem; text-align: center;">
                            <span class="material-icons-outlined" style="font-size: 3rem; color: var(--error);">error_outline</span>
                            <p style="margin-top: 1rem; color: var(--error);">Failed to load rental history. Please try again.</p>
                        </td>
                    </tr>
                `;
            }
        }

        // Modal and UI Functions
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
            document.body.style.overflow = 'hidden';

            // Load bookings when bookings modal is opened
            if (modalId === 'bookingsModal') {
                loadBookingRequests();
            }

            // Load active rentals when active rentals modal is opened
            if (modalId === 'activeRentalsModal') {
                loadActiveRentals();
            }

            // Load earnings when earnings modal is opened
            if (modalId === 'earningsModal') {
                loadEarningsData();
            }

            // Load rental history when rental history modal is opened
            if (modalId === 'rentalHistoryModal') {
                loadRentalHistory();
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function previewAvatar(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    const preview = document.getElementById('profile-avatar-preview');
                    preview.style.backgroundImage = 'url(' + e.target.result + ')';
                    preview.innerHTML = '';
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        function togglePasswordVisibility(icon) {
            const input = icon.previousElementSibling;
            if (input.type === 'password') {
                input.type = 'text';
                icon.textContent = 'visibility_off';
            } else {
                input.type = 'password';
                icon.textContent = 'visibility';
            }
        }

        function previewEquipmentImage(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    document.getElementById('image-preview').src = e.target.result;
                    document.getElementById('image-preview-container').style.display = 'block';
                    document.getElementById('upload-placeholder').style.display = 'none';
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        function removeImage(event) {
            event.stopPropagation();
            event.preventDefault();
            document.getElementById('fileInput').value = '';
            document.getElementById('image-preview').src = '';
            document.getElementById('image-preview-container').style.display = 'none';
            document.getElementById('upload-placeholder').style.display = 'block';
        }

        function submitNewListing() {
            const form = document.getElementById('addEquipmentForm');

            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            // Get form data
            const formData = new FormData();
            formData.append('equipment_name', document.getElementById('equipment_name').value);
            formData.append('category', document.getElementById('category').value);
            formData.append('price_per_day', document.getElementById('price_per_day').value);
            formData.append('condition', document.getElementById('condition').value);
            formData.append('availability', document.getElementById('availability').value);
            formData.append('description', document.getElementById('description').value);

            // Append specifications
            formData.append('model', document.getElementById('model').value);
            formData.append('year', document.getElementById('year').value);
            formData.append('fuel', document.getElementById('fuel').value);
            formData.append('capacity', document.getElementById('capacity').value);
            formData.append('location', document.getElementById('location').value);

            // Get owner info from localStorage
            const userData = JSON.parse(localStorage.getItem('agrohub_user') || '{}');
            formData.append('owner_name', userData.name || userData.email || 'Equipment Owner');
            formData.append('owner_id', userData.id || 1);

            // Add image if uploaded
            const fileInput = document.getElementById('fileInput');
            if (fileInput.files && fileInput.files[0]) {
                formData.append('equipment_image', fileInput.files[0]);
            }

            // Show loading state
            const submitBtn = event.target;
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<span class="material-icons-outlined" style="animation: spin 1s linear infinite;">sync</span> Publishing...';
            submitBtn.disabled = true;

            // Submit to backend
            fetch('php/add_equipment.php', {
                method: 'POST',
                body: formData
            })
                .then(response => response.json())
                .then(data => {
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;

                    if (data.success) {
                        // Show success message
                        showNotification('âœ… Equipment listed successfully! It now appears on both dashboards.', 'success');

                        // Close modal and reset form
                        closeModal('addEquipmentModal');
                        form.reset();
                        removeImage(new Event('click'));

                        // Reload equipment list to show new item
                        setTimeout(() => {
                            loadOwnerEquipment();
                            updateSidebarBadges();
                        }, 1000);
                    } else {
                        showNotification('âŒ Error: ' + (data.error || 'Failed to list equipment'), 'error');
                    }
                })
                .catch(error => {
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    console.error('Error:', error);
                    showNotification('âŒ Network error: Could not connect to server', 'error');
                });
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 1.25rem 1.5rem;
                    background: ${type === 'success' ? 'linear-gradient(135deg, #22c55e, #16a34a)' : 'linear-gradient(135deg, #ef4444, #dc2626)'};
                    color: white;
                    border - radius: 12px;
                    box - shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
                    z - index: 10000;
                    font - weight: 500;
                    animation: slideInRight 0.3s ease - out;
                    `;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease-in';
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }

        // Add spin animation to CSS
        if (!document.querySelector('#notification-animations')) {
            const style = document.createElement('style');
            style.id = 'notification-animations';
            style.textContent = `
                    @keyframes slideInRight {
                    from { transform: translateX(100 %); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes slideOutRight {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100 %); opacity: 0; }
                    }
                    @keyframes spin {
                    from { transform: rotate(0deg); }
                    to { transform: rotate(360deg); }
                    }
            `;
            document.head.appendChild(style);
        }

        const quickActionBtns = document.querySelectorAll('.quick-action-btn');
        quickActionBtns.forEach(btn => {
            btn.addEventListener('click', function () {
                const actionText = this.textContent.trim().toLowerCase();
                if (actionText.includes('new listing') || actionText.includes('add')) {
                    openModal('addEquipmentModal');
                } else if (actionText.includes('view all')) {
                    window.scrollTo({ top: document.querySelector('.equipment-section').offsetTop - 100, behavior: 'smooth' });
                }
            });
        });

        const serviceCardsFull = document.querySelectorAll('.service-card');
        serviceCardsFull.forEach(card => {
            card.addEventListener('click', function (e) {
                e.preventDefault();
                const title = this.querySelector('h3').textContent.toLowerCase();
                if (title.includes('add equipment')) {
                    openModal('addEquipmentModal');
                } else if (title.includes('manage bookings') || title.includes('requests')) {
                    openModal('bookingsModal');
                } else if (title.includes('agreements')) {
                    window.location.href = 'agreements.html';
                } else if (title.includes('earnings') || title.includes('revenue')) {
                    openModal('earningsModal');
                } else if (title.includes('analytics')) {
                    openModal('analyticsModal');
                } else if (title.includes('insurance')) {
                    alert('Insurance Portal: View and manage machine insurance policies. Feature coming soon!');
                } else if (title.includes('support')) {
                    alert('Support: Connecting you to an agent...');
                }
            });
        });

        // Top bar action handlers
        document.querySelector('[data-tooltip="Messages"]').addEventListener('click', () => {
            alert('Messages: Opening chat with farmers... Feature coming soon!');
        });

        document.querySelector('[data-tooltip="Notifications"]').addEventListener('click', () => {
            alert('Notifications: You have 3 new rental requests!');
        });

        const sidebarItemsList = document.querySelectorAll('.sidebar-nav .nav-item');
        sidebarItemsList.forEach(item => {
            item.addEventListener('click', function (e) {
                const text = this.textContent.toLowerCase().trim();

                // For direct links, don't prevent default
                if (text.includes('dashboard')) return;

                e.preventDefault();

                if (text.includes('add new listing')) {
                    openModal('addEquipmentModal');
                } else if (text.includes('booking requests')) {
                    openModal('bookingsModal');
                } else if (text.includes('active rentals')) {
                    openModal('activeRentalsModal');
                } else if (text.includes('rental history')) {
                    openModal('rentalHistoryModal');
                } else if (text.includes('earnings')) {
                    openModal('earningsModal');
                } else if (text.includes('analytics')) {
                    openModal('analyticsModal');
                } else if (text.includes('agreements')) {
                    window.location.href = 'agreements.html';
                } else if (text.includes('reviews')) {
                    openModal('reviewsModal');
                } else if (text.includes('my equipment')) {
                    window.scrollTo({ top: document.querySelector('.equipment-section').offsetTop - 100, behavior: 'smooth' });
                } else if (text.includes('profile')) {
                    openModal('profileModal');
                } else if (text.includes('settings')) {
                    openModal('settingsModal');
                }
            });
        });

        window.onclick = function (event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('active');
                document.body.style.overflow = 'auto';
            }
        }
    </script>

    <!-- Notifications Panel -->
    <div id="notificationsPanel">
        <div class="notification-header">
            <h3>ðŸ”” Rental Requests</h3>
            <button class="close-panel" onclick="toggleNotificationsPanel()">
                <span class="material-icons-outlined">close</span>
            </button>
        </div>
        <div class="notification-list" id="notificationList">
            <!-- Notifications will be loaded here -->
        </div>
    </div>

    <script>
        // Load Dashboard Stats (Earnings, Bookings, Listings)
        async function loadDashboardStats() {
            try {
                const userData = JSON.parse(localStorage.getItem('agrohub_user') || '{}');
                if (!userData.id) return;

                const response = await fetch(`php/get_earnings.php?owner_id=${userData.id}`);
                const data = await response.json();

                if (data.success && data.earnings) {
                    const stats = data.earnings;

                    // Helper to animate or set text
                    const setStat = (id, value, prefix = '') => {
                        const el = document.getElementById(id);
                        if (el) el.textContent = prefix + value;
                    };

                    setStat('totalEarnings', stats.total_earnings.toLocaleString('en-IN'), 'â‚¹');
                    setStat('totalBookings', stats.total_bookings);
                    setStat('activeListings', stats.active_listings);
                    setStat('avgRating', stats.average_rating.toFixed(1));

                    // Update Earnings Widget
                    const widgetEarnings = document.querySelector('.earnings-widget .earnings-amount');
                    if (widgetEarnings) {
                        widgetEarnings.textContent = 'â‚¹' + stats.total_earnings.toLocaleString('en-IN');
                    }
                }
            } catch (error) {
                console.error('Error loading dashboard stats:', error);
            }
        }

        // Toggle Notifications Panel
        function toggleNotificationsPanel() {
            const panel = document.getElementById('notificationsPanel');
            panel.classList.toggle('active');

            if (panel.classList.contains('active')) {
                loadOwnerNotifications();
            }
        }

        // Load Owner's Rental Notifications
        async function loadOwnerNotifications() {
            const userData = JSON.parse(localStorage.getItem('agrohub_user') || '{}');
            const notificationList = document.getElementById('notificationList');

            if (!userData.id) {
                notificationList.innerHTML = `
                    <div class="empty-notifications">
                        <span class="material-icons-outlined">login</span>
                        <p>Please log in to view notifications</p>
                    </div>
                `;
                return;
            }

            try {
                notificationList.innerHTML = '<p style="padding: 1rem; text-align: center; color: var(--text-gray);">Loading...</p>';

                const response = await fetch(`php/get_rental_requests.php?user_type=owner&user_id=${userData.id}&status=pending`);
                const data = await response.json();

                if (data.success && data.requests && data.requests.length > 0) {
                    // Update badge count
                    const badge = document.getElementById('notificationCount');
                    badge.textContent = data.count;
                    badge.style.display = 'flex';

                    notificationList.innerHTML = data.requests.map(request => `
                        <div class="notification-item pending">
                            <div class="notification-title">
                                ðŸšœ New Rental Request
                            </div>
                            <div class="notification-details">
                                <div><strong>Farmer:</strong> ${request.farmer_name}</div>
                                <div><strong>Equipment:</strong> ${request.equipment_name}</div>
                                <div><strong>Duration:</strong> ${request.start_date} to ${request.end_date} (${request.num_days} days)</div>
                                <div><strong>Total:</strong> â‚¹${parseFloat(request.total_amount).toLocaleString()}</div>
                                <div><strong>Location:</strong> ${request.delivery_address}</div>
                                ${request.need_operator ? '<div>âœ“ Operator Requested</div>' : ''}
                                ${request.need_insurance ? '<div>âœ“ Insurance Requested</div>' : ''}
                            </div>
                            <div class="notification-time">Requested: ${new Date(request.created_at).toLocaleDateString()} at ${new Date(request.created_at).toLocaleTimeString()}</div>
                            <div class="notification-actions">
                                <button class="btn-accept" onclick="updateRentalStatus(${request.id}, 'accepted', ${request.equipment_id})">
                                    âœ“ Accept
                                </button>
                                <button class="btn-decline" onclick="updateRentalStatus(${request.id}, 'declined', ${request.equipment_id})">
                                    âœ— Decline
                                </button>
                            </div>
                        </div>
                    `).join('');
                } else {
                    // No pending requests
                    const badge = document.getElementById('notificationCount');
                    badge.style.display = 'none';

                    notificationList.innerHTML = `
                        <div class="empty-notifications">
                            <span class="material-icons-outlined">notifications_none</span>
                            <p>No pending requests</p>
                            <p style="font-size: 0.85rem; margin-top: 0.5rem;">New rental requests will appear here</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading notifications:', error);
                notificationList.innerHTML = `
                    <div class="empty-notifications">
                        <span class="material-icons-outlined">error</span>
                        <p>Failed to load notifications</p>
                    </div>
                `;
            }
        }

        // Update Rental Request Status
        async function updateRentalStatus(requestId, status, equipmentId) {
            try {
                const response = await fetch('php/update_rental_status.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        request_id: requestId,
                        status: status,
                        equipment_id: equipmentId
                    })
                });

                const result = await response.json();

                if (result.success) {
                    alert(`Rental request ${status}!`);
                    loadOwnerNotifications(); // Refresh the list
                    loadOwnerEquipment(); // Refresh equipment (if status changed to booked)
                } else {
                    alert('Failed to update request: ' + (result.error || 'Unknown error'));
                }
            } catch (error) {
                console.error('Error updating rental status:', error);
                alert('Network error. Please try again.');
            }
        }

        // Load notifications logic
        async function updateNotificationBadge() {
            const userData = JSON.parse(localStorage.getItem('agrohub_user') || '{}');
            if (!userData.id) return;

            try {
                // Fetch rental requests count
                const requestsRes = await fetch(`php/get_rental_requests.php?user_type=owner&user_id=${userData.id}&status=pending`);
                const requestsData = await requestsRes.json();
                const requestsCount = (requestsData.success) ? requestsData.count : 0;

                // Fetch generic notifications count
                const notifRes = await fetch(`php/get_notifications.php?user_id=${userData.id}`);
                const notifData = await notifRes.json();
                const notifCount = (notifData.success) ? notifData.unread_count : 0;

                const totalCount = requestsCount + notifCount;
                const badge = document.getElementById('notificationCount');

                if (totalCount > 0) {
                    badge.textContent = totalCount;
                    badge.style.display = 'flex';
                } else {
                    badge.style.display = 'none';
                }
            } catch (error) {
                console.error('Error updating notifications:', error);
            }
        }

        // Load notifications on page load
        window.addEventListener('DOMContentLoaded', () => {
            loadDashboardStats();
            updateNotificationBadge();
            setInterval(updateNotificationBadge, 30000); // Check every 30 seconds

            // Check for expired rentals
            fetch('php/check_expired_rentals.php')
                .then(res => res.json())
                .then(data => {
                    console.log('Expired rentals check:', data);
                    if (data.updated_count > 0) {
                        // Refresh views if data changed
                        loadOwnerEquipment();
                    }
                })
                .catch(err => console.error('Error checking expired rentals:', err));
        });

        // Global variable to store equipment list
        let ownerEquipmentList = [];
        let equipmentToDelete = null;

        // Load Owner's Equipment
        async function loadOwnerEquipment() {
            const grid = document.getElementById('ownerEquipmentGrid');
            if (!grid) return;

            // Show loading state
            grid.innerHTML = `
                <div style="grid-column: 1/-1; text-align: center; padding: 4rem; background: white; border-radius: 20px;">
                    <span class="material-icons-outlined" style="font-size: 4rem; animation: spin 1s linear infinite; color: var(--primary-blue);">sync</span>
                    <p style="margin-top: 1rem; font-weight: 500; color: var(--text-gray);">Loading your equipment...</p>
                </div>
            `;

            try {
                // Get owner info from localStorage
                const userData = JSON.parse(localStorage.getItem('agrohub_user') || '{}');

                if (!userData.id) {
                    grid.innerHTML = `
                        <div style="grid-column: 1/-1; text-align: center; padding: 4rem; background: white; border-radius: 20px;">
                            <span class="material-icons-outlined" style="font-size: 4rem; color: var(--error);">error_outline</span>
                            <p style="margin-top: 1rem; color: var(--error);">Please log in to view your equipment</p>
                        </div>
                    `;
                    return;
                }

                // Fetch equipment from database
                const response = await fetch(`php/get_equipment.php?owner_id=${userData.id}`);
                const data = await response.json();

                if (data.success && data.equipment && data.equipment.length > 0) {
                    // Store equipment data globally
                    ownerEquipmentList = data.equipment;

                    // Render equipment cards
                    // Render equipment cards
                    grid.innerHTML = data.equipment.map(item => `
                        <div class="equipment-card" style="background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.08); transition: all 0.3s;">
                            <div style="position: relative; height: 200px; overflow: hidden;">
                                <img src="${item.image_url || 'https://images.unsplash.com/photo-1589923188900-85dae523342b?q=80&w=400'}" 
                                     style="width: 100%; height: 100%; object-fit: cover;" 
                                     alt="${item.equipment_name}"
                                     onerror="this.src='https://images.unsplash.com/photo-1589923188900-85dae523342b?q=80&w=400'">
                                <div style="position: absolute; top: 1rem; right: 1rem; background: ${item.availability_status === 'available' ? 'var(--success)' : item.availability_status === 'booked' ? 'var(--warning)' : 'var(--error)'}; color: white; padding: 0.4rem 0.8rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase;">
                                    ${item.availability_status}
                                </div>
                            </div>
                            <div style="padding: 1.5rem;">
                                <h3 style="font-size: 1.2rem; font-weight: 700; margin-bottom: 0.5rem; color: var(--text-dark);">${item.equipment_name}</h3>
                                <p style="font-size: 0.85rem; color: var(--text-gray); margin-bottom: 1rem;">${item.description ? item.description.substring(0, 80) + '...' : 'No description'}</p>
                                
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                    <span style="display: inline-flex; align-items: center; gap: 0.25rem; font-size: 0.8rem; color: var(--text-gray);">
                                        <span class="material-icons-outlined" style="font-size: 1rem;">category</span>
                                        ${item.category}
                                    </span>
                                    <span style="display: inline-flex; align-items: center; gap: 0.25rem; font-size: 0.8rem; color: var(--text-gray);">
                                        <span class="material-icons-outlined" style="font-size: 1rem;">location_on</span>
                                        ${item.location || 'Not specified'}
                                    </span>
                                </div>

                                <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 1rem; border-top: 1px solid #e5e7eb;">
                                    <div>
                                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary-blue);">â‚¹${parseFloat(item.price_per_day).toLocaleString()}</div>
                                        <div style="font-size: 0.75rem; color: var(--text-gray);">per day</div>
                                    </div>
                                    <div style="display: flex; gap: 0.5rem;">
                                        <button onclick="viewEquipmentDetails(${item.id})" 
                                                style="padding: 0.6rem 1rem; background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue)); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s;">
                                            View Details
                                        </button>
                                        <button onclick="deleteEquipment(event, ${item.id})" 
                                                style="padding: 0.6rem; background: rgba(239, 68, 68, 0.1); color: var(--error); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; justify-content: center;" title="Delete Listing">
                                            <span class="material-icons-outlined" style="font-size: 1.2rem;">delete</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `).join('');

                    // Update badge count
                    const badge = document.getElementById('equipmentCountBadge');
                    if (badge) badge.textContent = data.equipment.length;
                } else {
                    // No equipment found
                    grid.innerHTML = `
                        <div style="grid-column: 1/-1; text-align: center; padding: 4rem; background: white; border-radius: 20px;">
                            <span class="material-icons-outlined" style="font-size: 4rem; color: var(--text-light);">inventory_2</span>
                            <h3 style="margin-top: 1rem; color: var(--text-dark); font-size: 1.25rem;">No Equipment Listed Yet</h3>
                            <p style="margin-top: 0.5rem; color: var(--text-gray);">Start adding your equipment to receive rental requests</p>
                            <button onclick="openModal('addEquipmentModal')" 
                                    style="margin-top: 1.5rem; padding: 0.85rem 1.5rem; background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue)); color: white; border: none; border-radius: 12px; font-weight: 600; cursor: pointer;">
                                <span class="material-icons-outlined" style="vertical-align: middle; margin-right: 0.5rem;">add_circle</span>
                                Add Your First Equipment
                            </button>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading equipment:', error);
                grid.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 4rem; background: rgba(239, 68, 68, 0.1); border-radius: 20px; border: 2px dashed var(--error);">
                        <span class="material-icons-outlined" style="font-size: 4rem; color: var(--error);">error_outline</span>
                        <h3 style="margin-top: 1rem; color: var(--error);">Error Loading Equipment</h3>
                        <p style="margin-top: 0.5rem; color: var(--text-gray);">Could not connect to server. Please try again later.</p>
                    </div>
                `;
            }
        }

        // View Equipment Details
        function viewEquipmentDetails(equipmentId) {
            const equipment = ownerEquipmentList.find(e => e.id == equipmentId);
            if (!equipment) {
                console.error('Equipment details not found for ID:', equipmentId);
                return;
            }

            // Populate Modal
            document.getElementById('viewEqImage').src = equipment.image_url || 'https://images.unsplash.com/photo-1589923188900-85dae523342b?q=80&w=400';
            document.getElementById('viewEqName').textContent = equipment.equipment_name;
            document.getElementById('viewEqCategory').textContent = equipment.category;
            document.getElementById('viewEqLocation').textContent = equipment.location || 'Not specified';
            document.getElementById('viewEqPrice').textContent = parseFloat(equipment.price_per_day).toLocaleString();
            document.getElementById('viewEqDescription').textContent = equipment.description || 'No description provided.';

            // Specifications
            document.getElementById('viewEqModel').textContent = equipment.model || '--';
            document.getElementById('viewEqYear').textContent = equipment.year_of_manufacture || '--';
            document.getElementById('viewEqFuel').textContent = equipment.fuel_type || '--';
            document.getElementById('viewEqCapacity').textContent = equipment.capacity || '--';

            // Status Badge
            const statusBadge = document.getElementById('viewEqStatusBadge');
            statusBadge.textContent = equipment.availability_status;

            if (equipment.availability_status === 'available') {
                statusBadge.style.background = 'var(--success)';
            } else if (equipment.availability_status === 'booked') {
                statusBadge.style.background = 'var(--warning)';
            } else {
                statusBadge.style.background = 'var(--error)';
            }

            // Set Delete Button Handler
            const deleteBtn = document.getElementById('viewEqDeleteBtn');
            if (deleteBtn) {
                deleteBtn.onclick = function (e) {
                    deleteEquipment(e, equipmentId);
                };
            }

            // Open Modal
            document.getElementById('viewEquipmentDetailsModal').classList.add('active');
        }

        // Delete Equipment - Open Modal
        function deleteEquipment(event, equipmentId) {
            if (event) event.stopPropagation();
            equipmentToDelete = equipmentId;
            openModal('deleteConfirmationModal');
        }

        // Confirm Delete Equipment
        async function confirmDelete() {
            if (!equipmentToDelete) return;

            const submitBtn = document.getElementById('confirmDeleteBtn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = 'Deleting...';
            submitBtn.disabled = true;

            try {
                const userData = JSON.parse(localStorage.getItem('agrohub_user') || '{}');
                if (!userData.id) {
                    showNotification('Please log in to perform this action', 'error');
                    return;
                }

                const response = await fetch('php/delete_equipment.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        equipment_id: equipmentToDelete,
                        owner_id: userData.id
                    })
                });

                const data = await response.json();

                if (data.success) {
                    showNotification('ðŸ—‘ï¸ Equipment deleted successfully', 'success');

                    // Close details modal if it's open
                    const detailsModal = document.getElementById('viewEquipmentDetailsModal');
                    if (detailsModal && detailsModal.classList.contains('active')) {
                        closeModal('viewEquipmentDetailsModal');
                    }

                    // Reload equipment list
                    loadOwnerEquipment();
                    updateSidebarBadges();
                } else {
                    showNotification('âŒ Failed to delete: ' + (data.error || 'Unknown error'), 'error');
                }
            } catch (error) {
                console.error('Error deleting equipment:', error);
                showNotification('âŒ Network error. Please try again.', 'error');
            } finally {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
                closeModal('deleteConfirmationModal');
                equipmentToDelete = null;
            }
        }


        // Show All Bookings View
        function showAllBookings() {
            // Hide dashboard and equipment views
            const dashboardView = document.querySelector('.dashboard-grid');
            const equipmentView = document.getElementById('myEquipmentView');
            const bookingsView = document.getElementById('allBookingsView');

            if (dashboardView) dashboardView.style.display = 'none';
            if (equipmentView) equipmentView.style.display = 'none';
            if (bookingsView) {
                bookingsView.style.display = 'block';
                loadAllBookings();
            }

            // Update nav active state
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
        }

        // Global variable to store all bookings for filtering
        let allBookingsData = [];

        // Load All Bookings
        async function loadAllBookings(status = 'all') {
            const grid = document.getElementById('allBookingsGrid');
            if (!grid) return;

            // Show loading state
            grid.innerHTML = `
                <div style="text-align: center; padding: 4rem; background: white; border-radius: 20px;">
                    <span class="material-icons-outlined" style="font-size: 4rem; animation: spin 1s linear infinite; color: var(--primary-blue);">sync</span>
                    <p style="margin-top: 1rem; font-weight: 500; color: var(--text-gray);">Loading bookings...</p>
                </div>
            `;

            try {
                // Get owner info from localStorage
                const userData = JSON.parse(localStorage.getItem('agrohub_user') || '{}');

                if (!userData.id) {
                    grid.innerHTML = `
                        <div style="text-align: center; padding: 4rem; background: white; border-radius: 20px;">
                            <span class="material-icons-outlined" style="font-size: 4rem; color: var(--error);">error_outline</span>
                            <p style="margin-top: 1rem; color: var(--error);">Please log in to view bookings</p>
                        </div>
                    `;
                    return;
                }

                // Fetch bookings from database
                const url = status === 'all'
                    ? `php/get_rental_requests.php?user_type=owner&user_id=${userData.id}`
                    : `php/get_rental_requests.php?user_type=owner&user_id=${userData.id}&status=${status}`;

                const response = await fetch(url);
                const data = await response.json();

                if (data.success && data.requests && data.requests.length > 0) {
                    allBookingsData = data.requests; // Store for filtering
                    renderBookings(data.requests);
                } else {
                    // No bookings found
                    grid.innerHTML = `
                        <div style="text-align: center; padding: 4rem; background: white; border-radius: 20px;">
                            <span class="material-icons-outlined" style="font-size: 4rem; color: var(--text-light);">event_busy</span>
                            <h3 style="margin-top: 1rem; color: var(--text-dark); font-size: 1.25rem;">No Booking Requests</h3>
                            <p style="margin-top: 0.5rem; color: var(--text-gray);">${status === 'all' ? 'You haven\'t received any rental requests yet' : `No ${status} requests found`}</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading bookings:', error);
                grid.innerHTML = `
                    <div style="text-align: center; padding: 4rem; background: rgba(239, 68, 68, 0.1); border-radius: 20px; border: 2px dashed var(--error);">
                        <span class="material-icons-outlined" style="font-size: 4rem; color: var(--error);">error_outline</span>
                        <h3 style="margin-top: 1rem; color: var(--error);">Error Loading Bookings</h3>
                        <p style="margin-top: 0.5rem; color: var(--text-gray);">Could not connect to server. Please try again later.</p>
                    </div>
                `;
            }
        }

        // Render Bookings Cards
        function renderBookings(bookings) {
            const grid = document.getElementById('allBookingsGrid');
            if (!grid) return;

            grid.innerHTML = bookings.map(booking => {
                const statusColor = booking.booking_status === 'pending' ? 'var(--warning)' :
                    booking.booking_status === 'approved' ? 'var(--success)' : 'var(--error)';
                const statusBg = booking.booking_status === 'pending' ? 'rgba(245, 158, 11, 0.1)' :
                    booking.booking_status === 'approved' ? 'rgba(34, 197, 94, 0.1)' : 'rgba(239, 68, 68, 0.1)';

                return `
                    <div class="booking-card" style="background: white; border-radius: 20px; padding: 2rem; box-shadow: 0 4px 15px rgba(0,0,0,0.08); border-left: 4px solid ${statusColor};">
                        <div style="display: grid; grid-template-columns: auto 1fr auto; gap: 1.5rem; align-items: start;">
                            <!-- Farmer Avatar -->
                            <div style="width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, var(--primary-blue), var(--dark-blue)); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 1.5rem; flex-shrink: 0;">
                                ${booking.farmer_name ? booking.farmer_name.charAt(0).toUpperCase() : 'F'}
                            </div>

                            <!-- Booking Details -->
                            <div style="flex: 1;">
                                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                                    <div>
                                        <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text-dark); margin-bottom: 0.25rem;">${booking.farmer_name || 'Unknown Farmer'}</h3>
                                        <p style="font-size: 0.9rem; color: var(--text-gray);">${booking.equipment_name || 'Equipment'}</p>
                                    </div>
                                    <span style="background: ${statusBg}; color: ${statusColor}; padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.85rem; font-weight: 600; text-transform: capitalize;">
                                        ${booking.booking_status}
                                    </span>
                                </div>

                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span class="material-icons-outlined" style="color: var(--primary-blue); font-size: 1.2rem;">event</span>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-gray);">Start Date</div>
                                            <div style="font-weight: 600; color: var(--text-dark);">${booking.start_date}</div>
                                        </div>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span class="material-icons-outlined" style="color: var(--primary-blue); font-size: 1.2rem;">event_available</span>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-gray);">End Date</div>
                                            <div style="font-weight: 600; color: var(--text-dark);">${booking.end_date}</div>
                                        </div>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span class="material-icons-outlined" style="color: var(--success); font-size: 1.2rem;">payments</span>
                                        <div>
                                            <div style="font-size: 0.75rem; color: var(--text-gray);">Total Amount</div>
                                            <div style="font-weight: 700; color: var(--success); font-size: 1.1rem;">â‚¹${parseFloat(booking.total_amount || 0).toLocaleString()}</div>
                                        </div>
                                    </div>
                                </div>

                                ${booking.booking_status === 'pending' ? `
                                    <div style="display: flex; gap: 1rem;">
                                        <button onclick="updateBookingStatus(${booking.id}, 'approved', ${booking.equipment_id})"
                                                style="flex: 1; padding: 0.75rem 1.5rem; background: linear-gradient(135deg, var(--success), #16a34a); color: white; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s; display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem;">
                                            <span class="material-icons-outlined">check_circle</span>
                                            Approve
                                        </button>
                                        <button onclick="updateBookingStatus(${booking.id}, 'rejected', ${booking.equipment_id})"
                                                style="flex: 1; padding: 0.75rem 1.5rem; background: linear-gradient(135deg, var(--error), #dc2626); color: white; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s; display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem;">
                                            <span class="material-icons-outlined">cancel</span>
                                            Reject
                                        </button>
                                    </div>
                                ` : `
                                    <div style="padding: 0.75rem; background: ${statusBg}; border-radius: 12px; text-align: center; color: ${statusColor}; font-weight: 600;">
                                        ${booking.booking_status === 'approved' ? 'âœ“ Request Approved' : 'âœ— Request Rejected'}
                                    </div>
                                `}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Filter Bookings
        function filterBookings(status) {
            if (status === 'all') {
                renderBookings(allBookingsData);
            } else {
                const filtered = allBookingsData.filter(b => b.booking_status === status);
                if (filtered.length > 0) {
                    renderBookings(filtered);
                } else {
                    document.getElementById('allBookingsGrid').innerHTML = `
                        <div style="text-align: center; padding: 4rem; background: white; border-radius: 20px;">
                            <span class="material-icons-outlined" style="font-size: 4rem; color: var(--text-light);">filter_list_off</span>
                            <h3 style="margin-top: 1rem; color: var(--text-dark);">No ${status.charAt(0).toUpperCase() + status.slice(1)} Bookings</h3>
                            <p style="margin-top: 0.5rem; color: var(--text-gray);">No bookings found with this status</p>
                        </div>
                    `;
                }
            }
        }

        // Update Booking Status
        async function updateBookingStatus(bookingId, status, equipmentId) {
            if (!confirm(`Are you sure you want to ${status} this booking request?`)) {
                return;
            }

            try {
                const response = await fetch('php/update_rental_status.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        request_id: bookingId,
                        status: status,
                        equipment_id: equipmentId
                    })
                });

                const result = await response.json();

                if (result.success) {
                    // If approved, automatically generate agreement
                    if (status === 'approved') {
                        try {
                            const agrResponse = await fetch('php/generate_agreement.php', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({
                                    request_id: bookingId
                                })
                            });

                            const agrResult = await agrResponse.json();

                            if (agrResult.success) {
                                alert(`Booking approved successfully!\n\nAgreement ${agrResult.agreement_number} has been generated.\nThe farmer can now view and sign the agreement in their dashboard.`);
                            } else {
                                alert(`Booking approved, but agreement generation failed: ${agrResult.error}`);
                            }
                        } catch (agrError) {
                            console.error('Error generating agreement:', agrError);
                            alert('Booking approved, but agreement generation failed. Please try again later.');
                        }
                    } else {
                        alert(`Booking ${status} successfully!`);
                    }

                    loadAllBookings(); // Refresh the list
                } else {
                    alert('Failed to update booking: ' + (result.error || 'Unknown error'));
                }
            } catch (error) {
                console.error('Error updating booking:', error);
                alert('Network error. Please try again.');
            }
        }

        // Handle Sidebar Navigation
        document.querySelectorAll('.nav-item').forEach((link, index) => {
            link.addEventListener('click', function (e) {
                e.preventDefault();

                // Remove active class from all nav items
                document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));

                // Add active class to clicked item
                this.classList.add('active');

                // Get the dashboard-grid and myEquipmentView
                const dashboardView = document.querySelector('.dashboard-grid');
                const equipmentView = document.getElementById('myEquipmentView');
                const bookingsView = document.getElementById('allBookingsView');

                // Handle different views based on which link was clicked
                const linkText = this.textContent.trim();

                if (linkText.includes('Dashboard')) {
                    // Show dashboard overview, hide other views
                    if (dashboardView) dashboardView.style.display = 'block';
                    if (equipmentView) equipmentView.style.display = 'none';
                    if (bookingsView) bookingsView.style.display = 'none';
                } else if (linkText.includes('My Equipment')) {
                    // Hide dashboard overview, show equipment view
                    if (dashboardView) dashboardView.style.display = 'none';
                    if (bookingsView) bookingsView.style.display = 'none';
                    if (equipmentView) {
                        equipmentView.style.display = 'block';
                        // Load equipment when view is shown
                        loadOwnerEquipment();
                    }
                } else if (linkText.includes('Booking Requests')) {
                    // Hide other views, show bookings view
                    if (dashboardView) dashboardView.style.display = 'none';
                    if (equipmentView) equipmentView.style.display = 'none';
                    if (bookingsView) {
                        bookingsView.style.display = 'block';
                        loadAllBookings();
                    }
                }
                // Add more conditions here for other views as needed
            });
        });
    </script>
</body>

</html>